!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){(function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=i(2);!function(i,n){"object"===t(e)&&e.exports?e.exports=i.document?n(i):function(e){if(!e.document)throw new Error("Window with document not present");return n(e,!0)}:i.Aggregator=n(i,!0)}("undefined"!=typeof window?window:void 0,function(e,t){var i=e.FusionCharts;i.register("extension",["private","data-aggregator",function(){i.registerComponent("extensions","data-aggregator",n({FC:i}))}])})}).call(t,i(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){var t=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},a=function(e){return"object"===("undefined"==typeof e?"undefined":o(e))&&e.constructor===Object},r=function e(t,i,n){var r;for(r in i)r in t?"object"===o(i[r])&&e(t[r],i[r],n):a(i[r])?t[r]=n.extend2({},i[r]):t[r]=i[r]};Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;for(var o=0|t,a=Math.max(o>=0?o:n-Math.abs(o),0);a<n;){if(i[a]===e)return!0;a++}return!1}});var l=function(){function o(){i(this,o),this.appliedAggregation={binSize:null,aggregationMethod:null},this.config={}}return n(o,[{key:"getAvailablelAggreagation",value:function(){var e,t,i=this.config,n=i.dataAgg,o=i.avlTimePeriods=n.getAggregationTimeRules();for(i.avlTimeMultiplier=[],t=o.length,e=0;e<t;e++)i.avlTimeMultiplier.push(o[e].possibleFactors)}},{key:"getValidAggregation",value:function(){var e,t,i,n,o,a,r,l,s,g,u,d,c,f=this,p=f.config,h=f.tsObject,m=p.dataAgg,v=p.composition.reactiveModel.model["max-plot-point"],b=p.composition.dataset.category.minimumConsecutiveDifference,y=h.globalReactiveModel;y.prop("x-axis-maximum-allowed-ticks");for(p.currentTimeLength=y.model["x-axis-visible-range-end"]-y.model["x-axis-visible-range-start"],o=p.avlTimePeriods,a=p.avlTimeMultiplier,l=p.currentTimeLength,c=l/v,p.validTimePeriod=[],p.validTimePeriodMultiplier=[],p.avlAggMethods=m.getAllAggregationMethod(),e=0,i=o.length;e<i;e++){for(s=o[e].name,g=o[e].interval,r=[],t=0,n=a[e].length;t<n;t++)d=a[e][t],u=d*g,u>=c&&u>b&&r.push(a[e][t]);r.length>0&&(p.validTimePeriodMultiplier.push(r),p.validTimePeriod.push(s))}}},{key:"getCurrentAggreation",value:function(){var e,t,i,n=this,o=n.config,a=o.dataAgg,r=o.composition,l=r.reactiveModel;return i=l.prop("bin-size")-1,isFinite(i)&&(t=a.timeRules.getSuitableInterval(i),e=l.prop("aggregation-fn")),{timePeriod:t&&t.name,timePeriodMultiplier:t&&t.step,aggregationMethod:{value:e&&e.nickName,text:e&&e.formalName}}}},{key:"init",value:function(t){var i,n,o,a,r=this,l=r.config,s=l.toolboxComponent={},g="tsObject",u=["graphics","globalReactiveModel","chart","spaceManagerInstance","chartInstance","smartLabel","extData","parentGroup","lib",function(){var e=0,t=u.length-1,i="";for(r[g]=r[g]||{},r.requiredParams={},e=0;e<t;++e)i=u[e],r[g][i]=arguments[e]}];return t(u),i=r.tsObject,l.usrConfig=i.extData,n=i.chartInstance.apiInstance,o=n.getComponentStore(),l.composition=a=o.getCanvasByIndex(0).composition,l.dataAgg=a.impl.getDataAggregator(),s.toolbox=e.FC.getComponent("api","toolbox"),s.config={},r.toolbars=[],r.measurement={},r.toolbars.push(r.createToolbar()),a.reactiveModel.onPropsChange(["bin-size","aggregation-fn"],function(){l.execute&&(l.execute=!1,setTimeout(function(){r.rangeOnChange()},200))}),window.Aggregator=r,r}},{key:"createToolbar",value:function(){function e(e,t,i){var n;for(var o in e)v[t][o]&&(n=i&&v[t][o].states&&v[t][o].states[i]?v[t][o].states[i]:v[t][o].style),n&&C.cssAddRule("."+e[o],n)}function t(t,i,n){var o=S[t]=i(n).setConfig(v[t].attrs);o.setParentGroup(B),o.setConfig({className:v[t].className}),o.namespace("fusioncharts"),o.appendSelector("ext1-"+R++),e(o.getIndividualClassNames(o.getClassName()),t);var a=o.config.states;for(var r in a)e(o.getIndividualClassNames(a[r]),t,r);var l=o.config.dropDownMenu;for(var s in l){var g=l[s];switch(s){case"container":C.cssAddRule("."+g.className,v.dropDown.container.style);break;case"listItem":C.cssAddRule("."+g.className,v.dropDown.listItem.style);var u=g.states;for(var d in u)C.cssAddRule("."+u[d],v.dropDown.listItem.states[d].style)}}for(var c=v[t].eventListeners,f=0,p=c.length;f<p;f+=1){var h=c[f],m={};m[h.type]=h.cb,o.attachEventHandlers(m)}return o}function i(e){return t(e,T.selectButton,[])}function n(e){return t(e,T.button,v[e].attrs.label)}var o,a,l,s,g,u,d,c,f,p,h,m,v,b=this,y=b.config,M=b.tsObject,x=y.toolboxComponent,w=x.toolbox,S=x.config,P=w.HorizontalToolbar,k=w.ComponentGroup,A=M.graphics,C=A.paper,T=C.getInstances().d3,L=A.container,N=M.chart,z=M.smartLabel,O={paper:C,chart:N,smartLabel:z,chartContainer:L},I=function(){var e,t,i,n,o,a=u.value(),r=g.value(),l=r,s=y.validTimePeriod,d=y.validTimePeriodMultiplier,c=0;for(e=s.indexOf(a),t=d[e].indexOf(Number(r)),h=[],o=d[e],c=0,n=o.length;c<n;c++)i=o[c],h.push({name:i.toString(),value:i.toString()});g.updateList(h),t<0?g.value(d[e][0].toString()):g.value(l)},j=function(e){var t=b.getCurrentAggreation();t.timePeriodMultiplier=t.timePeriodMultiplier&&t.timePeriodMultiplier.toString(),t.timePeriodMultiplier!==g.value()||t.timePeriod!==u.value()||t.aggregationMethod.value!==d.value()?f.removeState("disabled"):f.setState("disabled"),d.value()||d.value(y.defaultAggMethod),u.value()||g.value()||(u.value(y.validTimePeriod[0]),I())};o=new k(O,{hPadding:4}),a=new k(O,{hPadding:0}),l=new k(O,{hPadding:0}),s=new P(O),m=y.usrConfig;var D={container:{style:{fill:"#fff",stroke:"#c8cecd","stroke-width":"1"},states:{selected:{stroke:"#1e1f1f"},hover:{cursor:"pointer"}}},text:{style:{fill:"#696969","font-size":"11px","font-family":'"Lucida Grande", sans-serif'}},arrow:{style:{fill:"#696969"}},attrs:{radius:2,width:50,height:22,margin:{right:3}}},G={label:{container:{height:22,style:{}},margin:{right:2},text:{style:{"font-size":"13px","font-family":'"Lucida Grande", sans-serif',"font-weight":"bold",fill:"#4b4b4b"}}},timeMulSelectMenu:{container:D.container,text:D.text,arrow:D.arrow,attrs:{radius:2,width:50,height:22,margin:{right:3,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:j}]},timePeriodSelectMenu:{container:D.container,text:D.text,arrow:D.arrow,attrs:{radius:2,width:90,height:22,margin:{right:9,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:function(){I(),j()}}]},aggMethodSelectMenu:{container:D.container,text:D.text,arrow:D.arrow,attrs:{radius:2,width:100,height:22,margin:{right:8,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:j}]},dropDown:{container:{style:{background:"#fff","border-color":"#898b8b","border-radius":"1px","border-style":"solid","border-width":"2px","font-size":"11px","font-family":'"Lucida Grande", sans-serif'}},listItem:{style:{},states:{hover:{className:void 0,style:{background:"#e6e8e8",color:"#696969",cursor:"pointer"}},selected:{className:void 0,style:{background:"#898b8b",color:"#fff"}}}}},applyButton:{container:{style:{fill:"#555",stroke:"#ced5d4","stroke-width":0},states:{disabled:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4"},hover:{cursor:"pointer"}}},text:{style:{fill:"#f3f3f3",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'},states:{disabled:{fill:"#f3f3f3"}}},attrs:{radius:1,width:54,height:22,margin:{right:3,left:0},label:"APPLY"},eventListeners:[{type:"click",cb:function(){b.apply(1)}}]},resetButton:{container:{style:{fill:"#898b8b",stroke:"#ced5d4",strokeWidth:0},states:{hover:{cursor:"pointer"},disabled:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4",cursor:"default"}}},text:{style:{fill:"#f3f3f3",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'},states:{disabled:{fill:"#f3f3f3"}}},attrs:{radius:1,shadow:{fill:"#000",opacity:.35},width:54,height:22,margin:{right:3,left:0},label:"RESET"},eventListeners:[{type:"click",cb:function(){b.apply(0)}}]}};v=G,m.styles&&(r(m.styles,G,this.tsObject.lib),v=m.styles),p=new w.Label("Aggregation: ",O,v.label),p.setConfig({className:v.label.className}),e(p.getIndividualClassNames(p.getClassName()),"label");var B=M.parentGroup,R=0;return o.addSymbol(p),o.setConfig({margin:{right:0}}),g=i("timeMulSelectMenu"),u=i("timePeriodSelectMenu"),d=i("aggMethodSelectMenu"),f=n("applyButton"),c=n("resetButton"),a.addSymbol(g),a.addSymbol(u),a.addSymbol(d),l.addSymbol(f),l.addSymbol(c),s.addComponent(o),s.addComponent(a),s.addComponent(l),s}},{key:"getLogicalSpace",value:function(e,t){var i,n,o,a=0,r=0;for(n=0,o=this.toolbars.length;n<o;n++)i=this.toolbars[n].getLogicalSpace(e,t),a=Math.max(i.width,a),r+=i.height,this.toolbars[n].width=i.width,this.toolbars[n].height=i.height;return r+=this.padding,{width:a,height:r}}},{key:"placeInCanvas",value:function(e){var t=this,i=t.tsObject,n=t.config.usrConfig;t.padding=5,i.spaceManagerInstance.add([{name:function(){return"data-aggregator"},ref:function(e){return e[0]},self:function(){return t},priority:function(){return 2},layout:function(e){return e[n.layout||"inline"]},orientation:[{type:function(e){return e[n.orientation||"horizontal"]},position:[{type:function(e){return e[n.position||"bottom"]},alignment:[{type:function(e){return e[n.alignment||"right"]},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(e,t,i,n,o){var a=this.measurement;return a.x=e,a.y=t,a.width=i,a.height=n,this.parentGroup=o,this}},{key:"apply",value:function(e){var t,i,n,o,a,r,l,s,g,u,d,c,f,p,h,m=this,v=m.config,b=v.toolboxComponent.config,y=b.timePeriodSelectMenu,M=b.timeMulSelectMenu,x=b.aggMethodSelectMenu,w=b.applyButton,S=b.resetButton,P=m.tsObject.extData.aggregate||{},k=v.composition.reactiveModel,A=m.aggregation,C=v.composition.impl;if(e){if(v.drawn){for(l=y.value(),s=M.value(),g=x.value(),f=v.avlTimePeriods,p=0,h=f.length;p<h;p++)if(u=f[p],u.name===l){c=u.interval;break}d=c*Number(s),k.lock().prop("bin-size-ext",d).prop("aggregation-fn-ext",v.avlAggMethods[g]).unlock(),A.binSize=d,A.aggregationMethod=g,w.setState("disabled"),S.removeState("disabled")}else if(l=P.timeUnit&&P.timeUnit.toString().toLowerCase(),s=P.timeMultiplier,g=P.method&&P.method.toString(),m.getValidAggregation(),t=v.validTimePeriod,i=v.validTimePeriodMultiplier,n=v.avlAggMethods,t.includes(l)&&(o=t.indexOf(l),i[o].includes(Number(s))||(s=i[o][0]),a=!0),n[g]&&(r=!0),a||r){if(a){for(f=v.avlTimePeriods,p=0,h=f.length;p<h;p++)if(u=f[p],u.name===l){c=u.interval;break}d=c*Number(s),k.lock().prop("bin-size-ext",d).unlock(),A.binSize=d}r&&(k.lock().prop("aggregation-fn-ext",v.avlAggMethods[g]).unlock(),A.aggregationMethod=g),w.setState("disabled"),S.removeState("disabled")}}else C.resetAggregation(),A.binSize=null,A.aggregationMethod=null,S.setState("disabled")}},{key:"rangeOnChange",value:function(){var e,i,n,o,a,r,l,s,g,u,d,c,f,p,h,m,v,b=this,y=b.config,M=y.toolboxComponent.config,x=M.timePeriodSelectMenu,w=M.timeMulSelectMenu,S=M.aggMethodSelectMenu,P=M.applyButton,k=M.resetButton,A=y.composition.reactiveModel,C=b.aggregation;for(b.getValidAggregation(),d=b.getCurrentAggreation(),c=d.timePeriod,f=d.timePeriodMultiplier,p=d.aggregationMethod,i=[],r=[],g=[],n=y.validTimePeriod,l=y.validTimePeriodMultiplier,u=y.avlAggMethods,P.setState("disabled"),C.binSize===A.prop("bin-size")||p.value!==y.defaultAggMethod&&p.value?k.removeState("disabled"):(C.binSize=null,C.aggregationMethod=null,k.setState("disabled")),h=0,m=n.length;h<m;h++)e=n[h],i.push({name:t(e),value:e});if(x.updateList(i),c?x.value(c):x.setPlaceHolderValue(""),o=n.indexOf(c),o>=0)for(v=l[o],h=0,m=v.length;h<m;h++)a=v[h],r.push({name:a.toString(),value:a.toString()});w.updateList(r),f?w.value(f.toString()):w.setPlaceHolderValue("");for(s in u)g.push({name:t(u[s].formalName),value:u[s].nickName});S.updateList(g),p.value?S.value(p.value):S.setPlaceHolderValue(""),y.execute=!0}},{key:"draw",value:function(e,t,i,n,o){var a,r,l,s=this,g=s.config,u=s.measurement,d=s.toolbars,c=g.dataAgg;if(s.getAvailablelAggreagation(),e=void 0===e?u.x:e,t=void 0===t?u.y:t,i=void 0===i?u.width:i,n=void 0===n?u.height:n,o=void 0===o?s.parentGroup:o,i&&n){for(r=0,a=d.length;r<a;r++)l=d[r],l.draw(e,t,o);g.defaultAggMethod=c.getDefaultAggregationMethod().nickName,!g.drawn&&s.apply(1),s.rangeOnChange(),g.drawn=!0}}},{key:"dispose",value:function(){}},{key:"aggregation",get:function(){return this.appliedAggregation},set:function(e){this.appliedAggregation.timePeriod=e.timePeriod,this.appliedAggregation.timePeriodMultiplier=e.timePeriodMultiplier,this.appliedAggregation.aggregationMethod=e.aggregationMethod}}]),o}();return l}}]);
//# sourceMappingURL=data-aggregator-es5.min.js.map