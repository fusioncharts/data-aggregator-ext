!function(e){function t(o){if(i[o])return i[o].exports;var n=i[o]={exports:{},id:o,loaded:!1};return e[o].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){(function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=i(2);!function(i,o){"object"===t(e)&&e.exports?e.exports=i.document?o(i):function(e){if(!e.document)throw new Error("Window with document not present");return o(e,!0)}:i.Aggregator=o(i,!0)}("undefined"!=typeof window?window:void 0,function(e,t){var i=e.FusionCharts;i.register("extension",["private","data-aggregator",function(){i.registerComponent("extensions","data-aggregator",o({FC:i}))}])})}).call(t,i(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();e.exports=function(e){var t=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},n=function(){function n(){i(this,n),this.appliedAggregation={binSize:null,aggregationMethod:null},this.config={}}return o(n,[{key:"getAvailablelAggreagation",value:function(){var e,t,i=this.config,o=i.dataAgg,n=i.avlTimePeriods=o.getAggregationTimeRules();for(i.avlTimeMultiplier=[],t=n.length,e=0;e<t;e++)i.avlTimeMultiplier.push(n[e].possibleFactors)}},{key:"getValidAggregation",value:function(){var e,t,i,o,n,a,l,r,d,u,g,s,c,f=this,p=f.config,h=f.tsObject,v=p.dataAgg,m=p.composition.reactiveModel.model["max-plot-point"],b=p.composition.dataset.category.minimumConsecutiveDifference;for(p.currentTimeLength=h.globalReactiveModel.model["x-axis-visible-range-end"]-h.globalReactiveModel.model["x-axis-visible-range-start"],n=p.avlTimePeriods,a=p.avlTimeMultiplier,r=p.currentTimeLength,p.minBinSize=c=r/m,p.validTimePeriod=[],p.validTimePeriodMultiplier=[],p.avlAggMethods=v.getAllAggregationMethod(),e=0,i=n.length;e<i;e++){for(d=n[e].name,u=n[e].interval,l=[],t=0,o=a[e].length;t<o;t++)s=a[e][t],g=s*u,g>=c&&g>b&&l.push(a[e][t]);l.length>0&&(p.validTimePeriodMultiplier.push(l),p.validTimePeriod.push(d))}}},{key:"getCurrentAggreation",value:function(){var e,t,i,o=this,n=o.config,a=n.dataAgg,l=n.composition,r=l.reactiveModel;return i=r.prop("bin-size")-1,isFinite(i)?(t=a.timeRules.getSuitableInterval(i),e=r.prop("aggregation-fn")):(t={name:"",step:""},n.validTimePeriod[n.validTimePeriod.length-1]=t.name,n.validTimePeriodMultiplier[n.validTimePeriodMultiplier.length-1]=[t.step],e=n.avlAggMethods.invalid={formalName:"",nickName:""}),{timePeriod:t.name,timePeriodMultiplier:t.step,aggregationMethod:{value:e.nickName,text:e.formalName}}}},{key:"init",value:function(t){var i,o,n,a,l=this,r=l.config,d=r.toolboxComponent={},u="tsObject",g=["graphics","globalReactiveModel","chart","spaceManagerInstance","chartInstance","smartLabel","extData",function(){var e=0,t=g.length-1,i="";for(l[u]=l[u]||{},l.requiredParams={},e=0;e<t;++e)i=g[e],l[u][i]=arguments[e]}];return t(g),i=l.tsObject,r.usrConfig=i.extData,o=i.chartInstance.apiInstance,n=o.getComponentStore(),r.composition=a=n.getCanvasByIndex(0).composition,r.dataAgg=a.impl.getDataAggregator(),d.toolbox=e.FC.getComponent("api","toolbox"),d.config={},l.toolbars=[],l.measurement={},l.toolbars.push(l.createToolbar()),a.reactiveModel.onPropsChange(["bin-size","aggregation-fn"],function(){r.execute&&(r.execute=!1,setTimeout(function(){l.rangeOnChange()},200))}),window.Aggregator=l,l}},{key:"createToolbar",value:function(){var e,t,i,o,n,a,l,r,d,u,g,s,c,f,p,h,v,m,b,y,M,w=this,S=w.config,x=w.tsObject,k=S.toolboxComponent,P=k.toolbox,A=k.config,C=P.HorizontalToolbar,F=P.ComponentGroup,T=P.SymbolStore,L=x.graphics,I=L.paper,B=L.container,D=x.chart,O=x.smartLabel,z={paper:I,chart:D,smartLabel:O,chartContainer:B},j=function(){var e,t,i=a.value(),o=n.value(),l=o,r=S.validTimePeriod,d=S.validTimePeriodMultiplier;e=r.indexOf(i),t=d[e].indexOf(Number(o)),s=[];var u=!0,c=!1,f=void 0;try{for(var p,h=d[e][Symbol.iterator]();!(u=(p=h.next()).done);u=!0)g=p.value,s.push({name:g.toString(),value:g.toString()})}catch(e){c=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw f}}n.updateList(s),t<0?n.value(d[e][0].toString()):n.value(l)},V=function(e){var t=w.getCurrentAggreation();t.timePeriodMultiplier.toString()!==n.value()||t.timePeriod!==a.value()||t.aggregationMethod.value!==l.value()?d.updateVisual("enabled"):d.updateVisual("disabled"),""===l.value()&&l.value(S.defaultAggMethod),""===a.value()&&""===n.value()&&(a.value(S.validTimePeriod[0]),j())};return e=new F(z,{hPadding:4}),t=new F(z,{hPadding:0}),i=new F(z,{hPadding:0}),o=new C(z),v=S.usrConfig,m=v.position||"bottom",b=v.alignment||"right","top"===m||"top"===b?h="bottom":"bottom"!==m&&"bottom"!==b||(h="top"),M=v.styles||{label:{"font-size":13,"font-family":'"Lucida Grande", sans-serif',"font-weight":"normal",fill:"#4b4b4b",height:22},timeMultiplierInputField:{active:{fill:"#fff",labelFill:"#696969",stroke:"#c8cecd",strokeWidth:1,radius:1,shadow:{fill:"#000",opacity:.35},width:50,height:22}},timePeriodInputField:{active:{fill:"#fff",labelFill:"#696969",stroke:"#c8cecd",strokeWidth:1,radius:1,shadow:{fill:"#000",opacity:.35},width:90,height:22}},aggregationMethodInputField:{active:{fill:"#fff",labelFill:"#696969",stroke:"#c8cecd",strokeWidth:1,radius:1,shadow:{fill:"#000",opacity:.35},width:100,height:22}},dropDown:{active:{fill:"#898b8b",labelFill:"#fff"},normal:{fill:"#fff",stroke:"#898b8b",radius:2,labelFill:"#000",hoverFill:"#e6e8e8",hoverLabelFill:"#696969"}},applyButton:{active:{fill:"#555",labelFill:"#f3f3f3",stroke:"#ced5d4",strokeWidth:0,hoverFill:"#555",hoverStrokeWidth:0,hoverStroke:"",radius:1,shadow:{fill:"#000",opacity:.35},width:54,height:22},inactive:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4",labelFill:"#f3f3f3"}},resetButton:{active:{fill:"#898b8b",labelFill:"#f3f3f3",stroke:"#ced5d4",strokeWidth:0,hoverFill:"#898b8b",hoverStrokeWidth:0,hoverStroke:"",radius:1,shadow:{fill:"#000",opacity:.35},width:54,height:22},inactive:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4",labelFill:"#f3f3f3"}},base:{font:{fontSize:11,fontFamily:'"Lucida Grande", sans-serif'}}},y=M||{},y={label:y.label||{},timeMultiplierInputField:{active:y.timeMultiplierInputField&&y.timeMultiplierInputField.active||{}},timePeriodInputField:{active:y.timePeriodInputField&&y.timePeriodInputField.active||{}},aggregationMethodInputField:{active:y.aggregationMethodInputField&&y.aggregationMethodInputField.active||{}},dropDown:{active:y.dropDown&&y.dropDown.active||{},normal:y.dropDown&&y.dropDown.normal||{}},applyButton:{active:y.applyButton&&y.applyButton.active||{},inactive:y.applyButton&&y.applyButton.inactive||{}},resetButton:{active:y.resetButton&&y.resetButton.active||{},inactive:y.resetButton&&y.resetButton.inactive||{}},base:{font:y.base&&y.base.font||{}}},e.setConfig({fill:"#fff",borderThickness:0}),t.setConfig({fill:"#fff",borderThickness:0}),i.setConfig({fill:"#fff",borderThickness:0}),o.setConfig({fill:"#fff",borderThickness:0}),f={disabled:{config:{disabled:y.applyButton.inactive}}},p={disabled:{config:{disabled:y.resetButton.inactive}}},c={selected:{container:{style:{fill:y.dropDown.active.fill}},text:{style:{fill:y.dropDown.active.labelFill}}},normal:{container:{style:{fill:y.dropDown.normal.fill,stroke:y.dropDown.normal.stroke,radius:y.dropDown.normal.radius}},text:{style:{fill:y.dropDown.normal.labelFill}}},hover:{container:{style:{fill:y.dropDown.normal.hoverFill}},text:{style:{fill:y.dropDown.normal.hoverLabelFill}}}},u=new P.Label("Aggregate Data:",z,{container:{height:y.label.height},text:{style:y.label}}),A.timePeriodSelectMenu=a=new P.SelectSymbol({},z,[],Object.assign(y.timePeriodInputField.active,{btnTextStyle:y.base.font,dropDownMenu:c,displayListAt:y.timePeriodInputField.active.displayListAt||h,margin:{right:8}})),A.timeMulSelectMenu=n=new P.SelectSymbol({},z,[],Object.assign(y.timeMultiplierInputField.active,{btnTextStyle:y.base.font,dropDownMenu:c,displayListAt:y.timeMultiplierInputField.active.displayListAt||h,margin:{right:3}})),A.aggMethodSelectMenu=l=new P.SelectSymbol({},z,[],Object.assign(y.aggregationMethodInputField.active,{btnTextStyle:y.base.font,displayListAt:y.aggregationMethodInputField.active.displayListAt||h,margin:{right:11},dropDownMenu:c})),A.applyButton=d=new P.Symbol("APPLY",!0,z,Object.assign(y.applyButton.active,{btnTextStyle:y.base.font,margin:{right:3}})).attachEventHandlers({click:function(){w.apply(1)}}),d.setStateConfig(f),A.resetButton=r=new P.Symbol("RESET",!0,z,Object.assign(y.resetButton.active,{btnTextStyle:y.base.font,margin:{right:3}})).attachEventHandlers({click:function(){w.apply(0)}}),r.setStateConfig(p),e.addSymbol(u),t.addSymbol(n),t.addSymbol(a),t.addSymbol(l),i.addSymbol(d),i.addSymbol(r),T.register("textBoxIcon",function(e,t,i,o,n,a,l){var r=e-o/2+a/2,d=e+o/2-a/2,u=t-n/2+l/2,g=t+n/2-l/2;return["M",r,u,"L",d,u,"L",d,g,"L",r,g,"Z"]}),a.attachEventHandlers({textOnChange:function(){j(),V()}}),n.attachEventHandlers({textOnChange:function(){V()}}),l.attachEventHandlers({textOnChange:function(){V()}}),o.addComponent(e),o.addComponent(t),o.addComponent(i),o}},{key:"getLogicalSpace",value:function(e,t){var i,o,n,a=0,l=0;for(o=0,n=this.toolbars.length;o<n;o++)i=this.toolbars[o].getLogicalSpace(e,t),a=Math.max(i.width,a),l+=i.height,this.toolbars[o].width=i.width,this.toolbars[o].height=i.height;return l+=this.padding,{width:a,height:l}}},{key:"placeInCanvas",value:function(e){var t=this,i=t.tsObject,o=t.config.usrConfig;t.padding=5,i.spaceManagerInstance.add([{name:function(){return"data-aggregator"},ref:function(e){return e[0]},self:function(){return t},priority:function(){return 2},layout:function(e){return e[o.layout||"inline"]},orientation:[{type:function(e){return e[o.orientation||"horizontal"]},position:[{type:function(e){return e[o.position||"bottom"]},alignment:[{type:function(e){return e[o.alignment||"right"]},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(e,t,i,o,n){var a=this.measurement;return a.x=e,a.y=t,a.width=i,a.height=o,this.parentGroup=n,this}},{key:"apply",value:function(e){var t,i,o,n,a,l,r,d,u,g,s,c,f=this,p=f.config,h=p.toolboxComponent.config,v=h.timePeriodSelectMenu,m=h.timeMulSelectMenu,b=h.aggMethodSelectMenu,y=h.applyButton,M=h.resetButton,w=f.tsObject.extData.aggregate||{},S=p.composition.reactiveModel,x=f.aggregation,k=p.composition.impl;if(e){if(p.drawn){r=v.value(),d=m.value(),u=b.value();var P=!0,A=!1,C=void 0;try{for(var F,T=p.avlTimePeriods[Symbol.iterator]();!(P=(F=T.next()).done);P=!0)if(g=F.value,g.name===r){c=g.interval;break}}catch(e){A=!0,C=e}finally{try{!P&&T.return&&T.return()}finally{if(A)throw C}}s=c*Number(d),S.lock().prop("bin-size-ext",s).prop("aggregation-fn-ext",p.avlAggMethods[u]).unlock(),x.binSize=s,x.aggregationMethod=u,y.updateVisual("disabled"),M.updateVisual("enabled")}else if(r=w.timeUnit&&w.timeUnit.toString().toLowerCase(),d=w.timeMultiplier,u=w.method&&w.method.toString().toLowerCase(),f.getValidAggregation(),t=p.validTimePeriod,i=p.validTimePeriodMultiplier,o=p.avlAggMethods,t.includes(r)&&(n=t.indexOf(r),i[n].includes(Number(d))||(d=i[n][0]),a=!0),o[u]&&(l=!0),a||l){if(a){var L=!0,I=!1,B=void 0;try{for(var D,O=p.avlTimePeriods[Symbol.iterator]();!(L=(D=O.next()).done);L=!0)if(g=D.value,g.name===r){c=g.interval;break}}catch(e){I=!0,B=e}finally{try{!L&&O.return&&O.return()}finally{if(I)throw B}}s=c*Number(d),S.lock().prop("bin-size-ext",s).unlock(),x.binSize=s}l&&(S.lock().prop("aggregation-fn-ext",p.avlAggMethods[u]).unlock(),x.aggregationMethod=u),y.updateVisual("disabled"),M.updateVisual("enabled")}}else k.resetAggregation(),x.binSize=null,x.aggregationMethod=null,M.updateVisual("disabled")}},{key:"rangeOnChange",value:function(){var e,i,o,n,a,l,r,d,u,g,s,c,f,p,h=this,v=h.config,m=v.toolboxComponent.config,b=m.timePeriodSelectMenu,y=m.timeMulSelectMenu,M=m.aggMethodSelectMenu,w=m.applyButton,S=m.resetButton,x=v.composition.reactiveModel,k=h.aggregation;h.getValidAggregation(),s=h.getCurrentAggreation(),c=s.timePeriod,f=s.timePeriodMultiplier,p=s.aggregationMethod,i=[],l=[],u=[],o=v.validTimePeriod,r=v.validTimePeriodMultiplier,g=v.avlAggMethods,w.updateVisual("disabled"),k.binSize===x.prop("bin-size")||p.value!==v.defaultAggMethod&&""!==p.value?S.updateVisual("enabled"):(k.binSize=null,k.aggregationMethod=null,S.updateVisual("disabled"));var P=!0,A=!1,C=void 0;try{for(var F,T=o[Symbol.iterator]();!(P=(F=T.next()).done);P=!0)e=F.value,i.push({name:t(e),value:e})}catch(e){A=!0,C=e}finally{try{!P&&T.return&&T.return()}finally{if(A)throw C}}if(b.updateList(i),b.value(c),n=o.indexOf(c),n>=0){var L=!0,I=!1,B=void 0;try{for(var D,O=r[n][Symbol.iterator]();!(L=(D=O.next()).done);L=!0)a=D.value,l.push({name:a.toString(),value:a.toString()})}catch(e){I=!0,B=e}finally{try{!L&&O.return&&O.return()}finally{if(I)throw B}}}y.updateList(l),y.value(f.toString());for(d in g)u.push({name:t(g[d].formalName),value:g[d].nickName});M.updateList(u),M.value(p.value),v.execute=!0}},{key:"draw",value:function(e,t,i,o,n){var a,l,r,d=this,u=d.config,g=d.measurement,s=d.toolbars,c=u.dataAgg;if(d.getAvailablelAggreagation(),e=void 0===e?g.x:e,t=void 0===t?g.y:t,i=void 0===i?g.width:i,o=void 0===o?g.height:o,n=void 0===n?d.parentGroup:n,i&&o)for(l=0,a=s.length;l<a;l++)r=s[l],r.draw(e,t,n);u.defaultAggMethod=c.getDefaultAggregationMethod().nickName,!u.drawn&&d.apply(1),d.rangeOnChange(),u.drawn=!0}},{key:"dispose",value:function(){}},{key:"aggregation",get:function(){return this.appliedAggregation},set:function(e){this.appliedAggregation.timePeriod=e.timePeriod,this.appliedAggregation.timePeriodMultiplier=e.timePeriodMultiplier,this.appliedAggregation.aggregationMethod=e.aggregationMethod}}]),n}();return n}}]);
//# sourceMappingURL=data-aggregator-es5.min.js.map