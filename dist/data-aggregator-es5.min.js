!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){(function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=i(2);!function(i,n){"object"===t(e)&&e.exports?e.exports=i.document?n(i):function(e){if(!e.document)throw new Error("Window with document not present");return n(e,!0)}:i.Aggregator=n(i,!0)}("undefined"!=typeof window?window:void 0,function(e,t){var i=e.FusionCharts;i.register("extension",["private","data-aggregator",function(){i.registerComponent("extensions","data-aggregator",n({FC:i}))}])})}).call(t,i(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){var t=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},o=function(e){return"object"===("undefined"==typeof e?"undefined":a(e))&&e.constructor===Object},r=function e(t,i,n){var r;for(r in i)r in t?"object"===a(i[r])&&e(t[r],i[r],n):o(i[r])?t[r]=n.extend2({},i[r]):t[r]=i[r]},l=function(){function a(){i(this,a),this.appliedAggregation={binSize:null,aggregationMethod:null},this.config={}}return n(a,[{key:"getAvailablelAggreagation",value:function(){var e,t,i=this.config,n=i.dataAgg,a=i.avlTimePeriods=n.getAggregationTimeRules();for(i.avlTimeMultiplier=[],t=a.length,e=0;e<t;e++)i.avlTimeMultiplier.push(a[e].possibleFactors)}},{key:"getValidAggregation",value:function(){var e,t,i,n,a,o,r,l,s,u,d,g,c,f=this,p=f.config,m=f.tsObject,h=p.dataAgg,v=p.composition.reactiveModel.model["max-plot-point"],b=p.composition.dataset.category.minimumConsecutiveDifference,y=m.globalReactiveModel;y.prop("x-axis-maximum-allowed-ticks");for(p.currentTimeLength=y.model["x-axis-visible-range-end"]-y.model["x-axis-visible-range-start"],a=p.avlTimePeriods,o=p.avlTimeMultiplier,l=p.currentTimeLength,c=l/v,p.validTimePeriod=[],p.validTimePeriodMultiplier=[],p.avlAggMethods=h.getAllAggregationMethod(),e=0,i=a.length;e<i;e++){for(s=a[e].name,u=a[e].interval,r=[],t=0,n=o[e].length;t<n;t++)g=o[e][t],d=g*u,d>=c&&d>b&&r.push(o[e][t]);r.length>0&&(p.validTimePeriodMultiplier.push(r),p.validTimePeriod.push(s))}}},{key:"getCurrentAggreation",value:function(){var e,t,i,n=this,a=n.config,o=a.dataAgg,r=a.composition,l=r.reactiveModel;return i=l.prop("bin-size")-1,isFinite(i)&&(t=o.timeRules.getSuitableInterval(i),e=l.prop("aggregation-fn")),{timePeriod:t&&t.name,timePeriodMultiplier:t&&t.step,aggregationMethod:{value:e&&e.nickName,text:e&&e.formalName}}}},{key:"init",value:function(t){var i,n,a,o,r=this,l=r.config,s=l.toolboxComponent={},u="tsObject",d=["graphics","globalReactiveModel","chart","spaceManagerInstance","chartInstance","smartLabel","extData","parentGroup","lib",function(){var e=0,t=d.length-1,i="";for(r[u]=r[u]||{},r.requiredParams={},e=0;e<t;++e)i=d[e],r[u][i]=arguments[e]}];return t(d),i=r.tsObject,l.usrConfig=i.extData,n=i.chartInstance.apiInstance,a=n.getComponentStore(),l.composition=o=a.getCanvasByIndex(0).composition,l.dataAgg=o.impl.getDataAggregator(),s.toolbox=e.FC.getComponent("api","toolbox"),s.config={},r.toolbars=[],r.measurement={},r.toolbars.push(r.createToolbar()),o.reactiveModel.onPropsChange(["bin-size","aggregation-fn"],function(){l.execute&&(l.execute=!1,setTimeout(function(){r.rangeOnChange()},200))}),window.Aggregator=r,r}},{key:"createToolbar",value:function(){function e(e,t,i){var n;for(var a in e)b[t][a]&&(n=i&&b[t][a].states&&b[t][a].states[i]?b[t][a].states[i]:b[t][a].style),n&&T.cssAddRule("."+e[a],n)}function t(t,i,n){var a=P[t]=i(n).setConfig(b[t].attrs);a.setParentGroup(R),a.setConfig({className:b[t].className}),a.namespace("fusioncharts"),a.appendSelector("ext1-"+F++),e(a.getIndividualClassNames(a.getClassName()),t);var o=a.config.states;for(var r in o)e(a.getIndividualClassNames(o[r]),t,r);var l=a.config.dropDownMenu;for(var s in l){var u=l[s];switch(s){case"container":T.cssAddRule("."+u.className,b.dropDown.container.style);break;case"listItem":T.cssAddRule("."+u.className,b.dropDown.listItem.style);var d=u.states;for(var g in d)T.cssAddRule("."+d[g],b.dropDown.listItem.states[g].style)}}for(var c=b[t].eventListeners,f=0,p=c.length;f<p;f+=1){var m=c[f],h={};h[m.type]=m.cb,a.attachEventHandlers(h)}return a}function i(e){return t(e,L.selectButton,[])}function n(e){return t(e,L.button,b[e].attrs.label)}var a,o,l,s,u,d,g,c,f,p,m,h,v,b,y=this,x=y.config,M=y.tsObject,S=x.toolboxComponent,w=S.toolbox,P=S.config,k=w.HorizontalToolbar,A=w.ComponentGroup,C=M.graphics,T=C.paper,L=T.getInstances().d3,N=C.container,z=M.chart,I=M.smartLabel,O={paper:T,chart:z,smartLabel:I,chartContainer:N},j=function(){var e,t,i=d.value(),n=u.value(),a=n,o=x.validTimePeriod,r=x.validTimePeriodMultiplier;e=o.indexOf(i),t=r[e].indexOf(Number(n)),h=[];var l=!0,s=!1,g=void 0;try{for(var c,f=r[e][Symbol.iterator]();!(l=(c=f.next()).done);l=!0)m=c.value,h.push({name:m.toString(),value:m.toString()})}catch(e){s=!0,g=e}finally{try{!l&&f.return&&f.return()}finally{if(s)throw g}}u.updateList(h),t<0?u.value(r[e][0].toString()):u.value(a)},D=function(e){var t=y.getCurrentAggreation();t.timePeriodMultiplier=t.timePeriodMultiplier&&t.timePeriodMultiplier.toString(),t.timePeriodMultiplier!==u.value()||t.timePeriod!==d.value()||t.aggregationMethod.value!==g.value()?f.removeState("disabled"):f.setState("disabled"),g.value()||g.value(x.defaultAggMethod),d.value()||u.value()||(d.value(x.validTimePeriod[0]),j())};a=new A(O,{hPadding:4}),o=new A(O,{hPadding:0}),l=new A(O,{hPadding:0}),s=new k(O),v=x.usrConfig;var G={container:{style:{fill:"#fff",stroke:"#c8cecd","stroke-width":"1"},states:{selected:{stroke:"#1e1f1f"},hover:{cursor:"pointer"}}},text:{style:{fill:"#696969","font-size":"11px","font-family":'"Lucida Grande", sans-serif'}},arrow:{style:{fill:"#696969"}},attrs:{radius:2,width:50,height:22,margin:{right:3}}},B={label:{container:{height:22,style:{}},margin:{right:2},text:{style:{"font-size":"13px","font-family":'"Lucida Grande", sans-serif',"font-weight":"bold",fill:"#4b4b4b"}}},timeMulSelectMenu:{container:G.container,text:G.text,arrow:G.arrow,attrs:{radius:2,width:50,height:22,margin:{right:3,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:D}]},timePeriodSelectMenu:{container:G.container,text:G.text,arrow:G.arrow,attrs:{radius:2,width:90,height:22,margin:{right:9,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:function(){j(),D()}}]},aggMethodSelectMenu:{container:G.container,text:G.text,arrow:G.arrow,attrs:{radius:2,width:100,height:22,margin:{right:8,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:D}]},dropDown:{container:{style:{background:"#fff","border-color":"#898b8b","border-radius":"1px","border-style":"solid","border-width":"2px","font-size":"11px","font-family":'"Lucida Grande", sans-serif'}},listItem:{style:{},states:{hover:{className:void 0,style:{background:"#e6e8e8",color:"#696969",cursor:"pointer"}},selected:{className:void 0,style:{background:"#898b8b",color:"#fff"}}}}},applyButton:{container:{style:{fill:"#555",stroke:"#ced5d4","stroke-width":0},states:{disabled:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4"},hover:{cursor:"pointer"}}},text:{style:{fill:"#f3f3f3",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'},states:{disabled:{fill:"#f3f3f3"}}},attrs:{radius:1,width:54,height:22,margin:{right:3,left:0},label:"APPLY"},eventListeners:[{type:"click",cb:function(){y.apply(1)}}]},resetButton:{container:{style:{fill:"#898b8b",stroke:"#ced5d4",strokeWidth:0},states:{hover:{cursor:"pointer"},disabled:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4",cursor:"default"}}},text:{style:{fill:"#f3f3f3",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'},states:{disabled:{fill:"#f3f3f3"}}},attrs:{radius:1,shadow:{fill:"#000",opacity:.35},width:54,height:22,margin:{right:3,left:0},label:"RESET"},eventListeners:[{type:"click",cb:function(){y.apply(0)}}]}};b=B,v.styles&&(r(v.styles,B,this.tsObject.lib),b=v.styles),p=new w.Label("Aggregation: ",O,b.label),p.setConfig({className:b.label.className}),e(p.getIndividualClassNames(p.getClassName()),"label");var R=M.parentGroup,F=0;return a.addSymbol(p),a.setConfig({margin:{right:0}}),u=i("timeMulSelectMenu"),d=i("timePeriodSelectMenu"),g=i("aggMethodSelectMenu"),f=n("applyButton"),c=n("resetButton"),o.addSymbol(u),o.addSymbol(d),o.addSymbol(g),l.addSymbol(f),l.addSymbol(c),s.addComponent(a),s.addComponent(o),s.addComponent(l),s}},{key:"getLogicalSpace",value:function(e,t){var i,n,a,o=0,r=0;for(n=0,a=this.toolbars.length;n<a;n++)i=this.toolbars[n].getLogicalSpace(e,t),o=Math.max(i.width,o),r+=i.height,this.toolbars[n].width=i.width,this.toolbars[n].height=i.height;return r+=this.padding,{width:o,height:r}}},{key:"placeInCanvas",value:function(e){var t=this,i=t.tsObject,n=t.config.usrConfig;t.padding=5,i.spaceManagerInstance.add([{name:function(){return"data-aggregator"},ref:function(e){return e[0]},self:function(){return t},priority:function(){return 2},layout:function(e){return e[n.layout||"inline"]},orientation:[{type:function(e){return e[n.orientation||"horizontal"]},position:[{type:function(e){return e[n.position||"bottom"]},alignment:[{type:function(e){return e[n.alignment||"right"]},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(e,t,i,n,a){var o=this.measurement;return o.x=e,o.y=t,o.width=i,o.height=n,this.parentGroup=a,this}},{key:"apply",value:function(e){var t,i,n,a,o,r,l,s,u,d,g,c,f=this,p=f.config,m=p.toolboxComponent.config,h=m.timePeriodSelectMenu,v=m.timeMulSelectMenu,b=m.aggMethodSelectMenu,y=m.applyButton,x=m.resetButton,M=f.tsObject.extData.aggregate||{},S=p.composition.reactiveModel,w=f.aggregation,P=p.composition.impl;if(e){if(p.drawn){l=h.value(),s=v.value(),u=b.value();var k=!0,A=!1,C=void 0;try{for(var T,L=p.avlTimePeriods[Symbol.iterator]();!(k=(T=L.next()).done);k=!0)if(d=T.value,d.name===l){c=d.interval;break}}catch(e){A=!0,C=e}finally{try{!k&&L.return&&L.return()}finally{if(A)throw C}}g=c*Number(s),S.lock().prop("bin-size-ext",g).prop("aggregation-fn-ext",p.avlAggMethods[u]).unlock(),w.binSize=g,w.aggregationMethod=u,y.setState("disabled"),x.removeState("disabled")}else if(l=M.timeUnit&&M.timeUnit.toString().toLowerCase(),s=M.timeMultiplier,u=M.method&&M.method.toString(),f.getValidAggregation(),t=p.validTimePeriod,i=p.validTimePeriodMultiplier,n=p.avlAggMethods,t.includes(l)&&(a=t.indexOf(l),i[a].includes(Number(s))||(s=i[a][0]),o=!0),n[u]&&(r=!0),o||r){if(o){var N=!0,z=!1,I=void 0;try{for(var O,j=p.avlTimePeriods[Symbol.iterator]();!(N=(O=j.next()).done);N=!0)if(d=O.value,d.name===l){c=d.interval;break}}catch(e){z=!0,I=e}finally{try{!N&&j.return&&j.return()}finally{if(z)throw I}}g=c*Number(s),S.lock().prop("bin-size-ext",g).unlock(),w.binSize=g}r&&(S.lock().prop("aggregation-fn-ext",p.avlAggMethods[u]).unlock(),w.aggregationMethod=u),y.setState("disabled"),x.removeState("disabled")}}else P.resetAggregation(),w.binSize=null,w.aggregationMethod=null,x.setState("disabled")}},{key:"rangeOnChange",value:function(){var e,i,n,a,o,r,l,s,u,d,g,c,f,p,m=this,h=m.config,v=h.toolboxComponent.config,b=v.timePeriodSelectMenu,y=v.timeMulSelectMenu,x=v.aggMethodSelectMenu,M=v.applyButton,S=v.resetButton,w=h.composition.reactiveModel,P=m.aggregation;m.getValidAggregation(),g=m.getCurrentAggreation(),c=g.timePeriod,f=g.timePeriodMultiplier,p=g.aggregationMethod,i=[],r=[],u=[],n=h.validTimePeriod,l=h.validTimePeriodMultiplier,d=h.avlAggMethods,M.setState("disabled"),P.binSize===w.prop("bin-size")||p.value!==h.defaultAggMethod&&p.value?S.removeState("disabled"):(P.binSize=null,P.aggregationMethod=null,S.setState("disabled"));var k=!0,A=!1,C=void 0;try{for(var T,L=n[Symbol.iterator]();!(k=(T=L.next()).done);k=!0)e=T.value,i.push({name:t(e),value:e})}catch(e){A=!0,C=e}finally{try{!k&&L.return&&L.return()}finally{if(A)throw C}}if(b.updateList(i),c?b.value(c):b.setPlaceHolderValue(""),a=n.indexOf(c),a>=0){var N=!0,z=!1,I=void 0;try{for(var O,j=l[a][Symbol.iterator]();!(N=(O=j.next()).done);N=!0)o=O.value,r.push({name:o.toString(),value:o.toString()})}catch(e){z=!0,I=e}finally{try{!N&&j.return&&j.return()}finally{if(z)throw I}}}y.updateList(r),f?y.value(f.toString()):y.setPlaceHolderValue("");for(s in d)u.push({name:t(d[s].formalName),value:d[s].nickName});x.updateList(u),p.value?x.value(p.value):x.setPlaceHolderValue(""),h.execute=!0}},{key:"draw",value:function(e,t,i,n,a){var o,r,l,s=this,u=s.config,d=s.measurement,g=s.toolbars,c=u.dataAgg;if(s.getAvailablelAggreagation(),e=void 0===e?d.x:e,t=void 0===t?d.y:t,i=void 0===i?d.width:i,n=void 0===n?d.height:n,a=void 0===a?s.parentGroup:a,i&&n){for(r=0,o=g.length;r<o;r++)l=g[r],l.draw(e,t,a);u.defaultAggMethod=c.getDefaultAggregationMethod().nickName,!u.drawn&&s.apply(1),s.rangeOnChange(),u.drawn=!0}}},{key:"dispose",value:function(){}},{key:"aggregation",get:function(){return this.appliedAggregation},set:function(e){this.appliedAggregation.timePeriod=e.timePeriod,this.appliedAggregation.timePeriodMultiplier=e.timePeriodMultiplier,this.appliedAggregation.aggregationMethod=e.aggregationMethod}}]),a}();return l}}]);
//# sourceMappingURL=data-aggregator-es5.min.js.map