(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false };modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports;}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0);})([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1);},function(module,exports,__webpack_require__){'use strict';const Aggregator=__webpack_require__(2);const FusionCharts=__webpack_require__(3);FusionCharts.register('extension',['data-aggregator',function(id){var global=this;var extAPI=global.extAPI;console.log(id);extAPI(new Aggregator())}]);},function(module,exports){(function(global){'use strict';class Aggregator{constructor(){this.appliedAggregation={timePeriod:null,timePeriodMultiplier:1,aggregationMethod:null};this.config={}}get aggregation(){return this.appliedAggregation}set aggregation(obj){this.appliedAggregation.timePeriod=obj.timePeriod;this.appliedAggregation.timePeriodMultiplier=obj.timePeriodMultiplier;this.appliedAggregation.aggregationMethod=obj.aggregationMethod}getTimeMultiplier(){}getAvailablelAggreagation(){var config=this.config,avlAggMethods,avlTimePeriods,currentVisibleRange,currentTimeLength,xAxis=global.x,chart=global.chart;avlAggMethods=chart.getAvailableAggregationMethod();avlTimePeriods=avlTimePeriods=chart.getAvailableTimePeriod();currentVisibleRange=xAxis.getCurrentVisibleRange();currentTimeLength=currentVisibleRange.endDate-currentVisibleRange.startDate;config.avlTimePeriods=avlTimePeriods;config.avlAggMethods=avlAggMethods;config.currentTimeLength=currentTimeLength}getValidTimeMultiplier(){var config=this.config,xAxis=global.x,i,len,currTimePeriod,nextTimePeriod,numOfMultiplier,currentTimeLength=xAxis.max-xAxis.min,avlTimePeriods=config.avlTimePeriods,getMultiplierArray=num=>Array.from({length:num},(v,k)=>k+1);config.avlTimeMultiplier=[];len=avlTimePeriods.length;for(i=0;i<len;i+=1){currTimePeriod=avlTimePeriods[i];nextTimePeriod=avlTimePeriods[(i+1)];if(nextTimePeriod){numOfMultiplier=nextTimePeriod[Object.keys(nextTimePeriod)[0]]/currTimePeriod[Object.keys(currTimePeriod)[0]]}else{numOfMultiplier=currentTimeLength/currTimePeriod[Object.keys(currTimePeriod)[0]]}config.avlTimeMultiplier.push(getMultiplierArray(numOfMultiplier))}}getValidAggregation(){var chartConfig=global.chart.config,config=this.config,i,j,len1,len2,avlTimePeriods,avlTimeMultiplier,minNumOfPlot=chartConfig.minNumOfPlot,minPlotWidth=chartConfig.minPlotWidth,canvasWidth=chartConfig.canvasWidth,currentTimeLength,timePeriod,time,expectedTime,multiplier,multiplierCounter,getMultiplierArray=num=>Array.from({length:num},(v,k)=>k+1),minTime,maxTime;avlTimePeriods=config.avlTimePeriods;avlTimeMultiplier=config.avlTimeMultiplier;currentTimeLength=config.currentTimeLength;config.minTime=minTime=(currentTimeLength/canvasWidth)*minPlotWidth;config.maxTime=maxTime=currentTimeLength/minNumOfPlot;config.validTimePeriod=[];config.validTimePeriodMultiplier=[];for(i=0,len1=avlTimePeriods.length;i<len1;i+=1){timePeriod=Object.keys(avlTimePeriods[i])[0];time=avlTimePeriods[i][Object.keys(avlTimePeriods[i])[0]];multiplierCounter=0;for(j=0,len2=avlTimeMultiplier[i].length;j<len2;j+=1){multiplier=avlTimeMultiplier[i][j];expectedTime=multiplier*time;if((expectedTime>=minTime)&&(expectedTime<=maxTime)){multiplierCounter+=1}}if(multiplierCounter){config.validTimePeriodMultiplier.push(getMultiplierArray(multiplierCounter));config.validTimePeriod.push(timePeriod)}}console.log(config.validTimePeriod,config.validTimePeriodMultiplier,config.avlAggMethods)}setAggregation(obj){var avlAggMethods,validTimePeriod,timePeriodIndex,validTimePeriodMultiplier,config=this.config;this.getValidAggregation();avlAggMethods=config.avlAggMethods;validTimePeriod=config.validTimePeriod;validTimePeriodMultiplier=config.validTimePeriodMultiplier;if(avlAggMethods.includes(obj.aggregationMethod)&&validTimePeriod.includes(obj.timePeriod)){timePeriodIndex=validTimePeriod.indexOf(obj.timePeriod);if(validTimePeriodMultiplier[timePeriodIndex].includes(obj.timePeriodMultiplier)){this.aggregation=obj;console.log(this.aggregation);return true}else{console.log(this.aggregation);return false}}else{console.log(this.aggregation);return false}}resetAggregation(){}init(require){require('X-Axis','chart',function(x,chart){global.x=x;global.chart=chart});this.getAvailablelAggreagation();this.getValidTimeMultiplier()}placeInCanvas(){}draw(){}dispose(){}}module.exports=Aggregator;}.call(exports,(function(){return this}())));},function(module,exports){'use strict';var FusionCharts=function(){};FusionCharts.register=function(ext,arr){var extName=arr[0];var fn=arr[1];console.log('Currently active extension: '+extName);fn.bind(this,565)()};FusionCharts.getComponent=function(componentType,componentName){var toolBox={x:24,y:56,width:100,height:20,index:4};if(componentType==='api'&&componentName==='toolbox'){return toolBox}return null};FusionCharts.extAPI=function(obj){obj.init(function(){var argsToApply=[];var cb=arguments[arguments.length-1];var getAvailableAggregationMethod=function(){return['sum','average','custom']};var getAvailableTimePeriod=function(){return[{'x':'100'},{'y':'200'},{'z':'1000'}]};var getCurrentVisibleRange=function(){return{startDate:0,endDate:1000}};for(var i=0;i<arguments.length-1;i+=1){if(arguments[i]==='X-Axis'){argsToApply.push({getCurrentVisibleRange:getCurrentVisibleRange,min:0,max:2000})}else if(arguments[i]==='chart'){argsToApply.push({getAvailableAggregationMethod:getAvailableAggregationMethod,getAvailableTimePeriod:getAvailableTimePeriod,config:{minNumOfPlot:5,minPlotWidth:3,canvasWidth:1000}})}}cb.apply(this,argsToApply)});obj.placeInCanvas();obj.draw();obj.dispose();obj.setAggregation({timePeriod:'x',timePeriodMultiplier:2,aggregationMethod:'sum'})};module.exports=FusionCharts;}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgZDhhYmE2NjcxM2U2OGIxNDFmZmYiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9mY3RzLWV4dC1hZ2dyZWdhdG9yLmpzIiwid2VicGFjazovLy8uL2xpYi9mdXNpb25jaGFydHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7O0FDdENBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBQzs7Ozs7OztBQ2JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWUsT0FBTztBQUN0QixpQkFBZ0IsT0FBTztBQUN2QixpQkFBZ0IsT0FBTztBQUN2QixpQkFBZ0IsT0FBTztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGFBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQThDLFlBQVk7O0FBRTFEO0FBQ0E7O0FBRUEsZ0JBQWUsU0FBUztBQUN4QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQThDLFlBQVk7QUFDMUQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLDhDQUE2QyxVQUFVO0FBQ3ZEO0FBQ0E7QUFDQTs7QUFFQSxzREFBcUQsVUFBVTtBQUMvRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsTUFBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7Ozs7Ozs7QUMvTUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBTztBQUNQO0FBQ0E7QUFDQSxRQUFPO0FBQ1A7QUFDQTtBQUNBLFFBQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsb0JBQW1CLDBCQUEwQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNULFFBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLElBQUc7O0FBRUg7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFHO0FBQ0g7O0FBRUEiLCJmaWxlIjoiZmN0cy1leHQtZGF0YWFnZ3JlZ2F0b3ItZXM2Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgZDhhYmE2NjcxM2U2OGIxNDFmZmZcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5jb25zdCBBZ2dyZWdhdG9yID0gcmVxdWlyZSgnLi9mY3RzLWV4dC1hZ2dyZWdhdG9yJyk7XG5jb25zdCBGdXNpb25DaGFydHMgPSByZXF1aXJlKCcuLi9saWIvZnVzaW9uY2hhcnRzJyk7XG5cbkZ1c2lvbkNoYXJ0cy5yZWdpc3RlcignZXh0ZW5zaW9uJywgWydkYXRhLWFnZ3JlZ2F0b3InLCBmdW5jdGlvbiAoaWQpIHtcbiAgdmFyIGdsb2JhbCA9IHRoaXM7XG4gIHZhciBleHRBUEkgPSBnbG9iYWwuZXh0QVBJO1xuICBjb25zb2xlLmxvZyhpZCk7XG5cbiAgLy8gdmFyIG90aGVyQVBJID0gRnVzaW9uQ2hhcnRzLmdldEV4dENvbXBvbmVudChpZCwgJ2FwaScsICdsZWdhY3lleHRhcGknKTtcbiAgLy8gdmFyIHRvb2xCb3hBcGkgPSBGdXNpb25DaGFydHMuZ2V0Q29tcG9uZW50KCdhcGknLCAndG9vbGJveCcpO1xuXG4gIGV4dEFQSShuZXcgQWdncmVnYXRvcigpKTtcbn1dKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG4vKipcbiAqIENsYXNzIHJlcHJlc2VudGluZyB0aGUgRGF0YSBBZ2dyZWdhdG9yLlxuICovXG5jbGFzcyBBZ2dyZWdhdG9yIHtcbiAgLyoqXG4gICAqIENyZWF0ZSBhIEFnZ3JlZ2F0b3IuXG4gICAqIEB0eXBlZGVmIHtvYmplY3R9IEFnZ3JlZ2F0b3IuYWdncmVnYXRpb25cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHRpbWVQZXJpb2QgLSBUaGUgdGltZSBpbnRlcnZhbCBvZiBhZ2dyZWdhdGlvbi5cbiAgICogQHByb3BlcnR5IHtudW1iZXJ9IHRpbWVQZXJpb2RNdWx0aXBsaWVyIC0gVGhlIG11bHRpcGxpZXIgb2YgdGltZSBpbnRlcnZhbC5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IGFnZ3JlZ2F0aW9uTWV0aG9kIC0gVGhlIG1ldGhvZCBhcHBsaWVkIHRvIGFnZ3JlZ2F0ZS5cbiAgICovXG4gIGNvbnN0cnVjdG9yICgpIHtcbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIHRoaXMuYXBwbGllZEFnZ3JlZ2F0aW9uID0ge1xuICAgICAgdGltZVBlcmlvZDogbnVsbCxcbiAgICAgIHRpbWVQZXJpb2RNdWx0aXBsaWVyOiAxLFxuICAgICAgYWdncmVnYXRpb25NZXRob2Q6IG51bGxcbiAgICB9O1xuICAgIHRoaXMuY29uZmlnID0ge307XG4gIH1cblxuICAvKipcbiAgICogQW4gb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgdGltZVBlcmlvZCwgdGltZVBlcmlvZE11bHRpcGxpZXIsIGFnZ3JlZ2F0aW9uTWV0aG9kLlxuICAgKiBAdHlwZSB7QWdncmVnYXRvci5hZ2dyZWdhdGlvbn1cbiAgICovXG4gIGdldCBhZ2dyZWdhdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwbGllZEFnZ3JlZ2F0aW9uO1xuICB9XG5cbiAgc2V0IGFnZ3JlZ2F0aW9uIChvYmopIHtcbiAgICB0aGlzLmFwcGxpZWRBZ2dyZWdhdGlvbi50aW1lUGVyaW9kID0gb2JqLnRpbWVQZXJpb2Q7XG4gICAgdGhpcy5hcHBsaWVkQWdncmVnYXRpb24udGltZVBlcmlvZE11bHRpcGxpZXIgPSBvYmoudGltZVBlcmlvZE11bHRpcGxpZXI7XG4gICAgdGhpcy5hcHBsaWVkQWdncmVnYXRpb24uYWdncmVnYXRpb25NZXRob2QgPSBvYmouYWdncmVnYXRpb25NZXRob2Q7XG4gIH1cblxuICBnZXRUaW1lTXVsdGlwbGllciAoKSB7XG5cbiAgfVxuXG4gIGdldEF2YWlsYWJsZWxBZ2dyZWFnYXRpb24gKCkge1xuICAgIHZhciBjb25maWcgPSB0aGlzLmNvbmZpZyxcbiAgICAgIGF2bEFnZ01ldGhvZHMsXG4gICAgICBhdmxUaW1lUGVyaW9kcyxcbiAgICAgIGN1cnJlbnRWaXNpYmxlUmFuZ2UsXG4gICAgICBjdXJyZW50VGltZUxlbmd0aCxcbiAgICAgIHhBeGlzID0gZ2xvYmFsLngsXG4gICAgICBjaGFydCA9IGdsb2JhbC5jaGFydDtcblxuICAgIGF2bEFnZ01ldGhvZHMgPSBjaGFydC5nZXRBdmFpbGFibGVBZ2dyZWdhdGlvbk1ldGhvZCgpO1xuICAgIGF2bFRpbWVQZXJpb2RzID0gYXZsVGltZVBlcmlvZHMgPSBjaGFydC5nZXRBdmFpbGFibGVUaW1lUGVyaW9kKCk7XG5cbiAgICBjdXJyZW50VmlzaWJsZVJhbmdlID0geEF4aXMuZ2V0Q3VycmVudFZpc2libGVSYW5nZSgpO1xuICAgIGN1cnJlbnRUaW1lTGVuZ3RoID0gY3VycmVudFZpc2libGVSYW5nZS5lbmREYXRlIC0gY3VycmVudFZpc2libGVSYW5nZS5zdGFydERhdGU7XG5cbiAgICBjb25maWcuYXZsVGltZVBlcmlvZHMgPSBhdmxUaW1lUGVyaW9kcztcbiAgICBjb25maWcuYXZsQWdnTWV0aG9kcyA9IGF2bEFnZ01ldGhvZHM7XG4gICAgY29uZmlnLmN1cnJlbnRUaW1lTGVuZ3RoID0gY3VycmVudFRpbWVMZW5ndGg7XG4gIH1cblxuICBnZXRWYWxpZFRpbWVNdWx0aXBsaWVyICgpIHtcbiAgICB2YXIgY29uZmlnID0gdGhpcy5jb25maWcsXG4gICAgICB4QXhpcyA9IGdsb2JhbC54LFxuICAgICAgaSxcbiAgICAgIGxlbixcbiAgICAgIGN1cnJUaW1lUGVyaW9kLFxuICAgICAgbmV4dFRpbWVQZXJpb2QsXG4gICAgICBudW1PZk11bHRpcGxpZXIsXG4gICAgICBjdXJyZW50VGltZUxlbmd0aCA9IHhBeGlzLm1heCAtIHhBeGlzLm1pbixcbiAgICAgIGF2bFRpbWVQZXJpb2RzID0gY29uZmlnLmF2bFRpbWVQZXJpb2RzLFxuICAgICAgZ2V0TXVsdGlwbGllckFycmF5ID0gbnVtID0+IEFycmF5LmZyb20oe2xlbmd0aDogbnVtfSwgKHYsIGspID0+IGsgKyAxKTtcblxuICAgIGNvbmZpZy5hdmxUaW1lTXVsdGlwbGllciA9IFtdO1xuICAgIGxlbiA9IGF2bFRpbWVQZXJpb2RzLmxlbmd0aDtcblxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgY3VyclRpbWVQZXJpb2QgPSBhdmxUaW1lUGVyaW9kc1tpXTtcbiAgICAgIG5leHRUaW1lUGVyaW9kID0gYXZsVGltZVBlcmlvZHNbKGkgKyAxKV07XG5cbiAgICAgIGlmIChuZXh0VGltZVBlcmlvZCkge1xuICAgICAgICBudW1PZk11bHRpcGxpZXIgPVxuICAgICAgICAgIG5leHRUaW1lUGVyaW9kW09iamVjdC5rZXlzKG5leHRUaW1lUGVyaW9kKVswXV0gLyBjdXJyVGltZVBlcmlvZFtPYmplY3Qua2V5cyhjdXJyVGltZVBlcmlvZClbMF1dO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbnVtT2ZNdWx0aXBsaWVyID1cbiAgICAgICAgICBjdXJyZW50VGltZUxlbmd0aCAvIGN1cnJUaW1lUGVyaW9kW09iamVjdC5rZXlzKGN1cnJUaW1lUGVyaW9kKVswXV07XG4gICAgICB9XG4gICAgICBjb25maWcuYXZsVGltZU11bHRpcGxpZXIucHVzaChnZXRNdWx0aXBsaWVyQXJyYXkobnVtT2ZNdWx0aXBsaWVyKSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0VmFsaWRBZ2dyZWdhdGlvbiAoKSB7XG4gICAgdmFyIGNoYXJ0Q29uZmlnID0gZ2xvYmFsLmNoYXJ0LmNvbmZpZyxcbiAgICAgIGNvbmZpZyA9IHRoaXMuY29uZmlnLFxuICAgICAgaSxcbiAgICAgIGosXG4gICAgICBsZW4xLFxuICAgICAgbGVuMixcbiAgICAgIGF2bFRpbWVQZXJpb2RzLFxuICAgICAgYXZsVGltZU11bHRpcGxpZXIsXG4gICAgICBtaW5OdW1PZlBsb3QgPSBjaGFydENvbmZpZy5taW5OdW1PZlBsb3QsXG4gICAgICBtaW5QbG90V2lkdGggPSBjaGFydENvbmZpZy5taW5QbG90V2lkdGgsXG4gICAgICBjYW52YXNXaWR0aCA9IGNoYXJ0Q29uZmlnLmNhbnZhc1dpZHRoLFxuICAgICAgY3VycmVudFRpbWVMZW5ndGgsXG4gICAgICB0aW1lUGVyaW9kLFxuICAgICAgdGltZSxcbiAgICAgIGV4cGVjdGVkVGltZSxcbiAgICAgIG11bHRpcGxpZXIsXG4gICAgICBtdWx0aXBsaWVyQ291bnRlcixcbiAgICAgIGdldE11bHRpcGxpZXJBcnJheSA9IG51bSA9PiBBcnJheS5mcm9tKHtsZW5ndGg6IG51bX0sICh2LCBrKSA9PiBrICsgMSksXG4gICAgICBtaW5UaW1lLFxuICAgICAgbWF4VGltZTtcblxuICAgIGF2bFRpbWVQZXJpb2RzID0gY29uZmlnLmF2bFRpbWVQZXJpb2RzO1xuICAgIGF2bFRpbWVNdWx0aXBsaWVyID0gY29uZmlnLmF2bFRpbWVNdWx0aXBsaWVyO1xuICAgIGN1cnJlbnRUaW1lTGVuZ3RoID0gY29uZmlnLmN1cnJlbnRUaW1lTGVuZ3RoO1xuXG4gICAgY29uZmlnLm1pblRpbWUgPSBtaW5UaW1lID0gKGN1cnJlbnRUaW1lTGVuZ3RoIC8gY2FudmFzV2lkdGgpICogbWluUGxvdFdpZHRoO1xuICAgIGNvbmZpZy5tYXhUaW1lID0gbWF4VGltZSA9IGN1cnJlbnRUaW1lTGVuZ3RoIC8gbWluTnVtT2ZQbG90O1xuXG4gICAgY29uZmlnLnZhbGlkVGltZVBlcmlvZCA9IFtdO1xuICAgIGNvbmZpZy52YWxpZFRpbWVQZXJpb2RNdWx0aXBsaWVyID0gW107XG5cbiAgICBmb3IgKGkgPSAwLCBsZW4xID0gYXZsVGltZVBlcmlvZHMubGVuZ3RoOyBpIDwgbGVuMTsgaSsrKSB7XG4gICAgICB0aW1lUGVyaW9kID0gT2JqZWN0LmtleXMoYXZsVGltZVBlcmlvZHNbaV0pWzBdO1xuICAgICAgdGltZSA9IGF2bFRpbWVQZXJpb2RzW2ldW09iamVjdC5rZXlzKGF2bFRpbWVQZXJpb2RzW2ldKVswXV07XG4gICAgICBtdWx0aXBsaWVyQ291bnRlciA9IDA7XG5cbiAgICAgIGZvciAoaiA9IDAsIGxlbjIgPSBhdmxUaW1lTXVsdGlwbGllcltpXS5sZW5ndGg7IGogPCBsZW4yOyBqKyspIHtcbiAgICAgICAgbXVsdGlwbGllciA9IGF2bFRpbWVNdWx0aXBsaWVyW2ldW2pdO1xuICAgICAgICBleHBlY3RlZFRpbWUgPSBtdWx0aXBsaWVyICogdGltZTtcblxuICAgICAgICBpZiAoKGV4cGVjdGVkVGltZSA+PSBtaW5UaW1lKSAmJiAoZXhwZWN0ZWRUaW1lIDw9IG1heFRpbWUpKSB7XG4gICAgICAgICAgbXVsdGlwbGllckNvdW50ZXIrKztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG11bHRpcGxpZXJDb3VudGVyKSB7XG4gICAgICAgIGNvbmZpZy52YWxpZFRpbWVQZXJpb2RNdWx0aXBsaWVyLnB1c2goZ2V0TXVsdGlwbGllckFycmF5KG11bHRpcGxpZXJDb3VudGVyKSk7XG4gICAgICAgIGNvbmZpZy52YWxpZFRpbWVQZXJpb2QucHVzaCh0aW1lUGVyaW9kKTtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc29sZS5sb2coY29uZmlnLnZhbGlkVGltZVBlcmlvZCwgY29uZmlnLnZhbGlkVGltZVBlcmlvZE11bHRpcGxpZXIsIGNvbmZpZy5hdmxBZ2dNZXRob2RzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgQWdncmVnYXRpb24gb24gdGltZSBzZXJpZXNcbiAgICovXG4gIHNldEFnZ3JlZ2F0aW9uIChvYmopIHtcbiAgICB2YXIgYXZsQWdnTWV0aG9kcyxcbiAgICAgIHZhbGlkVGltZVBlcmlvZCxcbiAgICAgIHRpbWVQZXJpb2RJbmRleCxcbiAgICAgIHZhbGlkVGltZVBlcmlvZE11bHRpcGxpZXIsXG4gICAgICBjb25maWcgPSB0aGlzLmNvbmZpZztcblxuICAgIHRoaXMuZ2V0VmFsaWRBZ2dyZWdhdGlvbigpO1xuXG4gICAgYXZsQWdnTWV0aG9kcyA9IGNvbmZpZy5hdmxBZ2dNZXRob2RzO1xuICAgIHZhbGlkVGltZVBlcmlvZCA9IGNvbmZpZy52YWxpZFRpbWVQZXJpb2Q7XG4gICAgdmFsaWRUaW1lUGVyaW9kTXVsdGlwbGllciA9IGNvbmZpZy52YWxpZFRpbWVQZXJpb2RNdWx0aXBsaWVyO1xuXG4gICAgaWYgKGF2bEFnZ01ldGhvZHMuaW5jbHVkZXMob2JqLmFnZ3JlZ2F0aW9uTWV0aG9kKSAmJiB2YWxpZFRpbWVQZXJpb2QuaW5jbHVkZXMob2JqLnRpbWVQZXJpb2QpKSB7XG4gICAgICB0aW1lUGVyaW9kSW5kZXggPSB2YWxpZFRpbWVQZXJpb2QuaW5kZXhPZihvYmoudGltZVBlcmlvZCk7XG4gICAgICBpZiAodmFsaWRUaW1lUGVyaW9kTXVsdGlwbGllclt0aW1lUGVyaW9kSW5kZXhdLmluY2x1ZGVzKG9iai50aW1lUGVyaW9kTXVsdGlwbGllcikpIHtcbiAgICAgICAgdGhpcy5hZ2dyZWdhdGlvbiA9IG9iajtcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5hZ2dyZWdhdGlvbik7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5hZ2dyZWdhdGlvbik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2codGhpcy5hZ2dyZWdhdGlvbik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlc2V0IEFwcGxpZWQgQWdncmVnYXRpb25cbiAgICovXG4gIHJlc2V0QWdncmVnYXRpb24gKCkge1xuXG4gIH1cblxuICBpbml0IChyZXF1aXJlKSB7XG4gICAgcmVxdWlyZSgnWC1BeGlzJywgJ2NoYXJ0JywgZnVuY3Rpb24gKHgsIGNoYXJ0KSB7XG4gICAgICBnbG9iYWwueCA9IHg7XG4gICAgICBnbG9iYWwuY2hhcnQgPSBjaGFydDtcbiAgICB9KTtcblxuICAgIHRoaXMuZ2V0QXZhaWxhYmxlbEFnZ3JlYWdhdGlvbigpO1xuICAgIHRoaXMuZ2V0VmFsaWRUaW1lTXVsdGlwbGllcigpO1xuICB9XG5cbiAgcGxhY2VJbkNhbnZhcyAoKSB7XG4gICAgLy8gc3BhY2UgbWFuYWdlbWVudFxuICB9XG5cbiAgZHJhdyAoKSB7XG4gICAgLy8gZHJhdyBleHRlbnNpb25cbiAgfVxuXG4gIGRpc3Bvc2UgKCkge1xuICAgIC8vIGRpc3Bvc2UgZXh0ZW5zaW9uXG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBBZ2dyZWdhdG9yO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9mY3RzLWV4dC1hZ2dyZWdhdG9yLmpzXG4gKiogbW9kdWxlIGlkID0gMlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xudmFyIEZ1c2lvbkNoYXJ0cyA9IGZ1bmN0aW9uICgpIHt9O1xuXG5GdXNpb25DaGFydHMucmVnaXN0ZXIgPSBmdW5jdGlvbiAoZXh0LCBhcnIpIHtcbiAgdmFyIGV4dE5hbWUgPSBhcnJbMF07XG4gIHZhciBmbiA9IGFyclsxXTtcbiAgY29uc29sZS5sb2coJ0N1cnJlbnRseSBhY3RpdmUgZXh0ZW5zaW9uOiAnICsgZXh0TmFtZSk7XG4gIGZuLmJpbmQodGhpcywgNTY1KSgpO1xufTtcblxuRnVzaW9uQ2hhcnRzLmdldENvbXBvbmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnRUeXBlLCBjb21wb25lbnROYW1lKSB7XG4gIHZhciB0b29sQm94ID0ge1xuICAgIHg6IDI0LFxuICAgIHk6IDU2LFxuICAgIHdpZHRoOiAxMDAsXG4gICAgaGVpZ2h0OiAyMCxcbiAgICBpbmRleDogNFxuICB9O1xuXG4gIGlmIChjb21wb25lbnRUeXBlID09PSAnYXBpJyAmJiBjb21wb25lbnROYW1lID09PSAndG9vbGJveCcpIHtcbiAgICByZXR1cm4gdG9vbEJveDtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufTtcblxuRnVzaW9uQ2hhcnRzLmV4dEFQSSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgb2JqLmluaXQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBhcmdzVG9BcHBseSA9IFtdO1xuICAgIHZhciBjYiA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV07XG5cbiAgICB2YXIgZ2V0QXZhaWxhYmxlQWdncmVnYXRpb25NZXRob2QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gWydzdW0nLCAnYXZlcmFnZScsICdjdXN0b20nXTtcbiAgICB9O1xuXG4gICAgdmFyIGdldEF2YWlsYWJsZVRpbWVQZXJpb2QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gW3tcbiAgICAgICAgJ3gnOiAnMTAwJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ3knOiAnMjAwJ1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ3onOiAnMTAwMCdcbiAgICAgIH1dO1xuICAgIH07XG5cbiAgICB2YXIgZ2V0Q3VycmVudFZpc2libGVSYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXJ0RGF0ZTogMCxcbiAgICAgICAgZW5kRGF0ZTogMTAwMCxcbiAgICAgIH07XG4gICAgfTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgaWYgKGFyZ3VtZW50c1tpXSA9PT0gJ1gtQXhpcycpIHtcbiAgICAgICAgYXJnc1RvQXBwbHkucHVzaCh7XG4gICAgICAgICAgZ2V0Q3VycmVudFZpc2libGVSYW5nZTogZ2V0Q3VycmVudFZpc2libGVSYW5nZSxcbiAgICAgICAgICBtaW46IDAsXG4gICAgICAgICAgbWF4OiAyMDAwXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmIChhcmd1bWVudHNbaV0gPT09ICdjaGFydCcpIHtcbiAgICAgICAgYXJnc1RvQXBwbHkucHVzaCh7XG4gICAgICAgICAgZ2V0QXZhaWxhYmxlQWdncmVnYXRpb25NZXRob2Q6IGdldEF2YWlsYWJsZUFnZ3JlZ2F0aW9uTWV0aG9kLFxuICAgICAgICAgIGdldEF2YWlsYWJsZVRpbWVQZXJpb2Q6IGdldEF2YWlsYWJsZVRpbWVQZXJpb2QsXG4gICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICBtaW5OdW1PZlBsb3Q6IDUsXG4gICAgICAgICAgICBtaW5QbG90V2lkdGg6IDMsXG4gICAgICAgICAgICBjYW52YXNXaWR0aDogMTAwMFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGNiLmFwcGx5KHRoaXMsIGFyZ3NUb0FwcGx5KTtcbiAgfSk7XG5cbiAgb2JqLnBsYWNlSW5DYW52YXMoKTtcblxuICBvYmouZHJhdygpO1xuXG4gIG9iai5kaXNwb3NlKCk7XG5cbiAgb2JqLnNldEFnZ3JlZ2F0aW9uKHtcbiAgICB0aW1lUGVyaW9kOiAneCcsXG4gICAgdGltZVBlcmlvZE11bHRpcGxpZXI6IDIsXG4gICAgYWdncmVnYXRpb25NZXRob2Q6ICdzdW0nXG4gIH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBGdXNpb25DaGFydHM7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vbGliL2Z1c2lvbmNoYXJ0cy5qc1xuICoqIG1vZHVsZSBpZCA9IDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdfQ==