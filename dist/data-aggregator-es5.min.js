!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){(function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=i(2);!function(i,n){"object"===t(e)&&e.exports?e.exports=i.document?n(i):function(e){if(!e.document)throw new Error("Window with document not present");return n(e,!0)}:i.Aggregator=n(i,!0)}("undefined"!=typeof window?window:void 0,function(e,t){var i=e.FusionCharts;i.register("extension",["private","data-aggregator",function(){i.registerComponent("extensions","data-aggregator",n({FC:i}))}])})}).call(t,i(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){var t=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},o=function(e){return"object"===("undefined"==typeof e?"undefined":a(e))&&e.constructor===Object},r=function e(t,i,n){var r;for(r in i)r in t?"object"===a(i[r])&&e(t[r],i[r],n):o(i[r])?t[r]=n.extend2({},i[r]):t[r]=i[r]};Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;for(var a=0|t,o=Math.max(a>=0?a:n-Math.abs(a),0);o<n;){if(i[o]===e)return!0;o++}return!1}});var l=function(){function a(){i(this,a),this.appliedAggregation={binSize:null,aggregationMethod:null},this.config={}}return n(a,[{key:"getAvailablelAggreagation",value:function(){var e,t,i=this.config,n=i.dataAgg,a=i.avlTimePeriods=n.getAggregationTimeRules();for(i.avlTimeMultiplier=[],t=a.length,e=0;e<t;e++)i.avlTimeMultiplier.push(a[e].possibleFactors)}},{key:"getValidAggregation",value:function(){var e,t,i,n,a,o,r,l,s,g,d,u,c,f=this,p=f.config,m=f.tsObject,h=p.dataAgg,v=p.composition.reactiveModel.model["max-plot-point"],b=p.composition.dataset.category.minimumConsecutiveDifference,y=m.globalReactiveModel;y.prop("x-axis-maximum-allowed-ticks");for(p.currentTimeLength=y.model["x-axis-visible-range-end"]-y.model["x-axis-visible-range-start"],a=p.avlTimePeriods,o=p.avlTimeMultiplier,l=p.currentTimeLength,c=l/v,p.validTimePeriod=[],p.validTimePeriodMultiplier=[],p.avlAggMethods=h.getAllAggregationMethod(),e=0,i=a.length;e<i;e++){for(s=a[e].name,g=a[e].interval,r=[],t=0,n=o[e].length;t<n;t++)u=o[e][t],d=u*g,d>=c&&d>b&&r.push(o[e][t]);r.length>0&&(p.validTimePeriodMultiplier.push(r),p.validTimePeriod.push(s))}}},{key:"getCurrentAggreation",value:function(){var e,t,i,n=this,a=n.config,o=a.dataAgg,r=a.composition,l=r.reactiveModel;return i=l.prop("bin-size")-1,isFinite(i)&&(t=o.timeRules.getSuitableInterval(i),e=l.prop("aggregation-fn")),{timePeriod:t&&t.name,timePeriodMultiplier:t&&t.step,aggregationMethod:{value:e&&e.nickName,text:e&&e.formalName}}}},{key:"init",value:function(t){var i,n,a,o,r=this,l=r.config,s=l.toolboxComponent={},g="tsObject",d=["graphics","globalReactiveModel","chart","spaceManagerInstance","chartInstance","smartLabel","extData","parentGroup","lib",function(){var e=0,t=d.length-1,i="";for(r[g]=r[g]||{},r.requiredParams={},e=0;e<t;++e)i=d[e],r[g][i]=arguments[e]}];return t(d),i=r.tsObject,l.usrConfig=i.extData,n=i.chartInstance.apiInstance,a=n.getComponentStore(),l.composition=o=a.getCanvasByIndex(0).composition,l.dataAgg=o.impl.getDataAggregator(),s.toolbox=e.FC.getComponent("api","toolbox"),s.config={},r.toolbars=[],r.measurement={},r.toolbars.push(r.createToolbar()),o.reactiveModel.onPropsChange(["bin-size","aggregation-fn"],function(){l.execute&&(l.execute=!1,setTimeout(function(){r.rangeOnChange()},200))}),window.Aggregator=r,r}},{key:"createToolbar",value:function(){function e(e,t,i){var n;for(var a in e)v[t][a]&&(n=i&&v[t][a].states&&v[t][a].states[i]?v[t][a].states[i]:v[t][a].style),n&&C.cssAddRule("."+e[a],n)}function t(t,i,n){var a=S[t]=i(n).setConfig(v[t].attrs);a.setParentGroup(B),a.setConfig({className:v[t].className}),a.namespace("fusioncharts"),a.appendSelector("ext1-"+R++),e(a.getIndividualClassNames(a.getClassName()),t);var o=a.config.states;for(var r in o)e(a.getIndividualClassNames(o[r]),t,r);var l=a.config.dropDownMenu;for(var s in l){var g=l[s];switch(s){case"container":C.cssAddRule("."+g.className,v.dropDown.container.style);break;case"listItem":C.cssAddRule("."+g.className,v.dropDown.listItem.style);var d=g.states;for(var u in d)C.cssAddRule("."+d[u],v.dropDown.listItem.states[u].style)}}for(var c=v[t].eventListeners,f=0,p=c.length;f<p;f+=1){var m=c[f],h={};h[m.type]=m.cb,a.attachEventHandlers(h)}return a}function i(e){return t(e,T.selectButton,[])}function n(e){return t(e,T.button,v[e].attrs.label)}var a,o,l,s,g,d,u,c,f,p,m,h,v,b=this,y=b.config,M=b.tsObject,x=y.toolboxComponent,w=x.toolbox,S=x.config,P=w.HorizontalToolbar,k=w.ComponentGroup,A=M.graphics,C=A.paper,T=C.getInstances().d3,L=A.container,N=M.chart,z=M.smartLabel,O={paper:C,chart:N,smartLabel:z,chartContainer:L},I=function(){var e,t,i,n,a,o=d.value(),r=g.value(),l=r,s=y.validTimePeriod,u=y.validTimePeriodMultiplier,c=0;for(e=s.indexOf(o),t=u[e].indexOf(Number(r)),m=[],a=u[e],c=0,n=a.length;c<n;c++)i=a[c],m.push({name:i.toString(),value:i.toString()});g.updateList(m),t<0?g.value(u[e][0].toString()):g.value(l)},j=function(e){var t=b.getCurrentAggreation();t.timePeriodMultiplier=t.timePeriodMultiplier&&t.timePeriodMultiplier.toString(),t.timePeriodMultiplier!==g.value()||t.timePeriod!==d.value()||t.aggregationMethod.value!==u.value()?f.removeState("disabled"):f.setState("disabled"),u.value()||u.value(y.defaultAggMethod),d.value()||g.value()||(d.value(y.validTimePeriod[0]),I())};a=new k(O,{hPadding:4}),o=new k(O,{hPadding:0}),l=new k(O,{hPadding:0}),s=new P(O),h=y.usrConfig;var D={container:{style:{fill:"#fff",stroke:"#c8cecd","stroke-width":"1"},states:{selected:{stroke:"#1e1f1f"},hover:{cursor:"pointer"}}},text:{style:{fill:"#696969","font-size":"11px","font-family":'"Lucida Grande", sans-serif'}},arrow:{style:{fill:"#696969"}},attrs:{radius:2,width:50,height:22,margin:{right:3}}},G={label:{className:"data-aggregator-"+C.getId(),container:{height:22,style:{}},margin:{right:2},text:{style:{"font-size":"13px","font-family":'"Lucida Grande", sans-serif',fill:"#696969","font-weight":"bold"}}},timeMulSelectMenu:{container:D.container,text:D.text,arrow:D.arrow,attrs:{radius:2,width:50,height:22,margin:{right:3,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:j}]},timePeriodSelectMenu:{container:D.container,text:D.text,arrow:D.arrow,attrs:{radius:2,width:90,height:22,margin:{right:9,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:function(){I(),j()}}]},aggMethodSelectMenu:{container:D.container,text:D.text,arrow:D.arrow,attrs:{radius:2,width:100,height:22,margin:{right:8,left:0},padding:{left:10,right:8}},eventListeners:[{type:"change",cb:j}]},dropDown:{container:{style:{background:"#fff","border-color":"#898b8b","border-radius":"1px","border-style":"solid","border-width":"2px","font-size":"11px","font-family":'"Lucida Grande", sans-serif'}},listItem:{style:{},states:{hover:{className:void 0,style:{background:"#e6e8e8",color:"#696969",cursor:"pointer"}},selected:{className:void 0,style:{background:"#898b8b",color:"#fff"}}}}},applyButton:{container:{style:{fill:"#555",stroke:"#ced5d4","stroke-width":0},states:{disabled:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4"},hover:{cursor:"pointer"}}},text:{style:{fill:"#f3f3f3",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'},states:{disabled:{fill:"#f3f3f3"}}},attrs:{radius:1,width:54,height:22,margin:{right:3,left:0},label:"APPLY"},eventListeners:[{type:"click",cb:function(){b.apply(1)}}]},resetButton:{container:{style:{fill:"#898b8b",stroke:"#ced5d4",strokeWidth:0},states:{hover:{cursor:"pointer"},disabled:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4",cursor:"default"}}},text:{style:{fill:"#f3f3f3",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'},states:{disabled:{fill:"#f3f3f3"}}},attrs:{radius:1,shadow:{fill:"#000",opacity:.35},width:54,height:22,margin:{right:3,left:0},label:"RESET"},eventListeners:[{type:"click",cb:function(){b.apply(0)}}]}};v=G,h.styles&&(r(h.styles,G,this.tsObject.lib),v=h.styles),p=new w.Label("Aggregate Data:",O,v.label),p.setConfig({className:v.label.className}),e(p.getIndividualClassNames(p.getClassName()),"label");var B=M.parentGroup,R=0;return a.addSymbol(p),a.setConfig({margin:{right:0}}),g=i("timeMulSelectMenu"),d=i("timePeriodSelectMenu"),u=i("aggMethodSelectMenu"),f=n("applyButton"),c=n("resetButton"),o.addSymbol(g),o.addSymbol(d),o.addSymbol(u),l.addSymbol(f),l.addSymbol(c),s.addComponent(a),s.addComponent(o),s.addComponent(l),s}},{key:"getLogicalSpace",value:function(e,t){var i,n,a,o=0,r=0;for(n=0,a=this.toolbars.length;n<a;n++)i=this.toolbars[n].getLogicalSpace(e,t),o=Math.max(i.width,o),r+=i.height,this.toolbars[n].width=i.width,this.toolbars[n].height=i.height;return r+=this.padding,{width:o,height:r}}},{key:"placeInCanvas",value:function(e){var t=this,i=t.tsObject,n=t.config.usrConfig;t.padding=5,i.spaceManagerInstance.add([{name:function(){return"data-aggregator"},ref:function(e){return e[0]},self:function(){return t},priority:function(){return 2},layout:function(e){return e[n.layout||"inline"]},orientation:[{type:function(e){return e[n.orientation||"horizontal"]},position:[{type:function(e){return e[n.position||"bottom"]},alignment:[{type:function(e){return e[n.alignment||"right"]},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(e,t,i,n,a){var o=this.measurement;return o.x=e,o.y=t,o.width=i,o.height=n,this.parentGroup=a,this}},{key:"apply",value:function(e){var t,i,n,a,o,r,l,s,g,d,u,c,f,p,m,h=this,v=h.config,b=v.toolboxComponent.config,y=b.timePeriodSelectMenu,M=b.timeMulSelectMenu,x=b.aggMethodSelectMenu,w=b.applyButton,S=b.resetButton,P=h.tsObject.extData.aggregate||{},k=v.composition.reactiveModel,A=h.aggregation,C=v.composition.impl;if(e){if(v.drawn){for(l=y.value(),s=M.value(),g=x.value(),f=v.avlTimePeriods,p=0,m=f.length;p<m;p++)if(d=f[p],d.name===l){c=d.interval;break}u=c*Number(s),k.lock().prop("bin-size-ext",u).prop("aggregation-fn-ext",v.avlAggMethods[g]).unlock(),A.binSize=u,A.aggregationMethod=g,w.setState("disabled"),S.removeState("disabled")}else if(l=P.timeUnit&&P.timeUnit.toString().toLowerCase(),s=P.timeMultiplier,g=P.method&&P.method.toString(),h.getValidAggregation(),t=v.validTimePeriod,i=v.validTimePeriodMultiplier,n=v.avlAggMethods,t.includes(l)&&(a=t.indexOf(l),i[a].includes(Number(s))||(s=i[a][0]),o=!0),n[g]&&(r=!0),o||r){if(o){for(f=v.avlTimePeriods,p=0,m=f.length;p<m;p++)if(d=f[p],d.name===l){c=d.interval;break}u=c*Number(s),k.lock().prop("bin-size-ext",u).unlock(),A.binSize=u}r&&(k.lock().prop("aggregation-fn-ext",v.avlAggMethods[g]).unlock(),A.aggregationMethod=g),w.setState("disabled"),S.removeState("disabled")}}else C.resetAggregation(),A.binSize=null,A.aggregationMethod=null,S.setState("disabled")}},{key:"rangeOnChange",value:function(){var e,i,n,a,o,r,l,s,g,d,u,c,f,p,m,h,v,b=this,y=b.config,M=y.toolboxComponent.config,x=M.timePeriodSelectMenu,w=M.timeMulSelectMenu,S=M.aggMethodSelectMenu,P=M.applyButton,k=M.resetButton,A=y.composition.reactiveModel,C=b.aggregation;for(b.getValidAggregation(),u=b.getCurrentAggreation(),c=u.timePeriod,f=u.timePeriodMultiplier,p=u.aggregationMethod,i=[],r=[],g=[],n=y.validTimePeriod,l=y.validTimePeriodMultiplier,d=y.avlAggMethods,P.setState("disabled"),C.binSize===A.prop("bin-size")||p.value!==y.defaultAggMethod&&p.value?k.removeState("disabled"):(C.binSize=null,C.aggregationMethod=null,k.setState("disabled")),m=0,h=n.length;m<h;m++)e=n[m],i.push({name:t(e),value:e});if(x.updateList(i),c?x.value(c):x.setPlaceHolderValue(""),a=n.indexOf(c),a>=0)for(v=l[a],m=0,h=v.length;m<h;m++)o=v[m],r.push({name:o.toString(),value:o.toString()});w.updateList(r),f?w.value(f.toString()):w.setPlaceHolderValue("");for(s in d)g.push({name:t(d[s].formalName),value:d[s].nickName});S.updateList(g),p.value?S.value(p.value):S.setPlaceHolderValue(""),y.execute=!0}},{key:"draw",value:function(e,t,i,n,a){var o,r,l,s=this,g=s.config,d=s.measurement,u=s.toolbars,c=g.dataAgg;if(s.getAvailablelAggreagation(),e=void 0===e?d.x:e,t=void 0===t?d.y:t,i=void 0===i?d.width:i,n=void 0===n?d.height:n,a=void 0===a?s.parentGroup:a,i&&n){for(r=0,o=u.length;r<o;r++)l=u[r],l.draw(e,t,a);g.defaultAggMethod=c.getDefaultAggregationMethod().nickName,!g.drawn&&s.apply(1),s.rangeOnChange(),g.drawn=!0}}},{key:"dispose",value:function(){}},{key:"aggregation",get:function(){return this.appliedAggregation},set:function(e){this.appliedAggregation.timePeriod=e.timePeriod,this.appliedAggregation.timePeriodMultiplier=e.timePeriodMultiplier,this.appliedAggregation.aggregationMethod=e.aggregationMethod}}]),a}();return l}}]);
//# sourceMappingURL=data-aggregator-es5.min.js.map