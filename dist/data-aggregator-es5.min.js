!function(e){function t(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){(function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=i(2);!function(i,a){"object"===t(e)&&e.exports?e.exports=i.document?a(i):function(e){if(!e.document)throw new Error("Window with document not present");return a(e,!0)}:i.Aggregator=a(i,!0)}("undefined"!=typeof window?window:void 0,function(e,t){var i=e.FusionCharts;i.register("extension",["private","data-aggregator",function(){i.registerComponent("extensions","data-aggregator",a({FC:i}))}])})}).call(t,i(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){var t=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},o=function(e){return"object"===("undefined"==typeof e?"undefined":n(e))&&e.constructor===Object},r=function e(t,i,a){var r;for(r in i)r in t?"object"===n(i[r])&&e(t[r],i[r],a):o(i[r])?t[r]=a.extend2({},i[r]):t[r]=i[r]},l=function(){function n(){i(this,n),this.appliedAggregation={binSize:null,aggregationMethod:null},this.config={}}return a(n,[{key:"getAvailablelAggreagation",value:function(){var e,t,i=this.config,a=i.dataAgg,n=i.avlTimePeriods=a.getAggregationTimeRules();for(i.avlTimeMultiplier=[],t=n.length,e=0;e<t;e++)i.avlTimeMultiplier.push(n[e].possibleFactors)}},{key:"getValidAggregation",value:function(){var e,t,i,a,n,o,r,l,s,u,d,g,c,f=this,p=f.config,m=f.tsObject,h=p.dataAgg,v=p.composition.reactiveModel.model["max-plot-point"],b=p.composition.dataset.category.minimumConsecutiveDifference,y=m.globalReactiveModel,x=y.prop("x-axis-maximum-allowed-ticks");for(p.currentTimeLength=y.model["x-axis-visible-range-end"]-y.model["x-axis-visible-range-start"],n=p.avlTimePeriods,o=p.avlTimeMultiplier,l=p.currentTimeLength,c=l/v,p.validTimePeriod=[],p.validTimePeriodMultiplier=[],p.avlAggMethods=h.getAllAggregationMethod(),e=0,i=n.length;e<i;e++){for(s=n[e].name,u=n[e].interval,r=[],t=0,a=o[e].length;t<a;t++)g=o[e][t],d=g*u,d>=c&&d>b&&l>x*d*.5&&r.push(o[e][t]);r.length>0&&(p.validTimePeriodMultiplier.push(r),p.validTimePeriod.push(s))}}},{key:"getCurrentAggreation",value:function(){var e,t,i,a=this,n=a.config,o=n.dataAgg,r=n.composition,l=r.reactiveModel;return i=l.prop("bin-size")-1,isFinite(i)&&(t=o.timeRules.getSuitableInterval(i),e=l.prop("aggregation-fn")),{timePeriod:t&&t.name,timePeriodMultiplier:t&&t.step,aggregationMethod:{value:e&&e.nickName,text:e&&e.formalName}}}},{key:"init",value:function(t){var i,a,n,o,r=this,l=r.config,s=l.toolboxComponent={},u="tsObject",d=["graphics","globalReactiveModel","chart","spaceManagerInstance","chartInstance","smartLabel","extData","parentGroup","lib",function(){var e=0,t=d.length-1,i="";for(r[u]=r[u]||{},r.requiredParams={},e=0;e<t;++e)i=d[e],r[u][i]=arguments[e]}];return t(d),i=r.tsObject,l.usrConfig=i.extData,a=i.chartInstance.apiInstance,n=a.getComponentStore(),l.composition=o=n.getCanvasByIndex(0).composition,l.dataAgg=o.impl.getDataAggregator(),s.toolbox=e.FC.getComponent("api","toolbox"),s.config={},r.toolbars=[],r.measurement={},r.toolbars.push(r.createToolbar()),o.reactiveModel.onPropsChange(["bin-size","aggregation-fn"],function(){l.execute&&(l.execute=!1,setTimeout(function(){r.rangeOnChange()},200))}),window.Aggregator=r,r}},{key:"createToolbar",value:function(){function e(e,t,i){var a;for(var n in e)b[t][n]&&(a=i&&b[t][n].states&&b[t][n].states[i]?b[t][n].states[i]:b[t][n].style),a&&T.cssAddRule("."+e[n],a)}function t(t,i,a){var n=k[t]=i(a).setConfig(b[t].attrs);n.setParentGroup(R),n.setConfig({className:b[t].className}),n.namespace("fusioncharts"),n.appendSelector("ext1-"+F++),e(n.getIndividualClassNames(n.getClassName()),t);var o=n.config.states;for(var r in o)e(n.getIndividualClassNames(o[r]),t,r);var l=n.config.dropDownMenu;for(var s in l){var u=l[s];switch(s){case"container":T.cssAddRule("."+u.className,b.dropDown.container.style);break;case"listItem":T.cssAddRule("."+u.className,b.dropDown.listItem.style);var d=u.states;for(var g in d)T.cssAddRule("."+d[g],b.dropDown.listItem.states[g].style)}}for(var c=b[t].eventListeners,f=0,p=c.length;f<p;f+=1){var m=c[f],h={};h[m.type]=m.cb,n.attachEventHandlers(h)}return n}function i(e){return t(e,L.selectButton,[])}function a(e){return t(e,L.button,b[e].attrs.label)}var n,o,l,s,u,d,g,c,f,p,m,h,v,b,y=this,x=y.config,M=y.tsObject,S=x.toolboxComponent,w=S.toolbox,k=S.config,P=w.HorizontalToolbar,A=w.ComponentGroup,C=M.graphics,T=C.paper,L=T.getInstances().d3,N=C.container,z=M.chart,I=M.smartLabel,O={paper:T,chart:z,smartLabel:I,chartContainer:N},D=function(){var e,t,i=d.value(),a=u.value(),n=a,o=x.validTimePeriod,r=x.validTimePeriodMultiplier;e=o.indexOf(i),t=r[e].indexOf(Number(a)),h=[];var l=!0,s=!1,g=void 0;try{for(var c,f=r[e][Symbol.iterator]();!(l=(c=f.next()).done);l=!0)m=c.value,h.push({name:m.toString(),value:m.toString()})}catch(e){s=!0,g=e}finally{try{!l&&f.return&&f.return()}finally{if(s)throw g}}u.updateList(h),t<0?u.value(r[e][0].toString()):u.value(n)},j=function(e){var t=y.getCurrentAggreation();t.timePeriodMultiplier=t.timePeriodMultiplier&&t.timePeriodMultiplier.toString(),t.timePeriodMultiplier!==u.value()||t.timePeriod!==d.value()||t.aggregationMethod.value!==g.value()?f.removeState("disabled"):f.setState("disabled"),g.value()||g.value(x.defaultAggMethod),d.value()||u.value()||(d.value(x.validTimePeriod[0]),D())};n=new A(O,{hPadding:4}),o=new A(O,{hPadding:0}),l=new A(O,{hPadding:0}),s=new P(O),v=x.usrConfig;var G={container:{style:{fill:"#fff",stroke:"#c8cecd","stroke-width":"1"},states:{selected:{stroke:"#1e1f1f"},hover:{cursor:"pointer"}}},text:{style:{fill:"#696969",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'}},arrow:{style:{fill:"#696969"}},attrs:{radius:2,width:50,height:22,margin:{right:3}}},B={label:{container:{height:22,style:{}},text:{style:{"font-size":13,"font-family":'"Lucida Grande", sans-serif',"font-weight":"normal",fill:"#4b4b4b"}}},timeMulSelectMenu:{container:G.container,text:G.text,arrow:G.arrow,attrs:{radius:2,width:50,height:22,margin:{right:3}},eventListeners:[{type:"change",cb:j}]},timePeriodSelectMenu:{container:G.container,text:G.text,arrow:G.arrow,attrs:{radius:2,width:90,height:22,margin:{right:8}},eventListeners:[{type:"change",cb:function(){D(),j()}}]},aggMethodSelectMenu:{container:G.container,text:G.text,arrow:G.arrow,attrs:{radius:2,width:100,height:22,margin:{right:11}},eventListeners:[{type:"change",cb:j}]},dropDown:{container:{style:{background:"#fff","border-color":"#898b8b","border-radius":"1px","border-style":"solid","border-width":"2px","font-size":"11px","font-family":'"Lucida Grande", sans-serif'}},listItem:{style:{},states:{hover:{className:void 0,style:{background:"#e6e8e8",color:"#696969",cursor:"pointer"}},selected:{className:void 0,style:{background:"#898b8b",color:"#fff"}}}}},applyButton:{container:{style:{fill:"#555",stroke:"#ced5d4","stroke-width":0},states:{disabled:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4"}}},text:{style:{fill:"#f3f3f3",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'},states:{hover:{fill:"#555","stroke-width":0,stroke:""},disabled:{fill:"#f3f3f3"}}},attrs:{radius:1,width:54,height:22,margin:{right:3},label:"APPLY"},eventListeners:[{type:"click",cb:function(){y.apply(1)}}]},resetButton:{container:{style:{fill:"#898b8b",stroke:"#ced5d4",strokeWidth:0},states:{hover:{cursor:"pointer"},disabled:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4",cursor:"default"}}},text:{style:{fill:"#f3f3f3",fontSize:"11px",fontFamily:'"Lucida Grande", sans-serif'},states:{disabled:{fill:"#f3f3f3"}}},attrs:{radius:1,shadow:{fill:"#000",opacity:.35},width:54,height:22,margin:{right:3},label:"RESET"},eventListeners:[{type:"click",cb:function(){y.apply(0)}}]}};b=B,v.styles&&(r(v.styles,B,this.tsObject.lib),b=v.styles),p=new w.Label("Aggregate Data:",O,b.label),p.setConfig({className:b.label.className}),e(p.getIndividualClassNames(p.getClassName()),"label");var R=M.parentGroup,F=0;return n.addSymbol(p),u=i("timeMulSelectMenu"),d=i("timePeriodSelectMenu"),g=i("aggMethodSelectMenu"),f=a("applyButton"),c=a("resetButton"),o.addSymbol(u),o.addSymbol(d),o.addSymbol(g),l.addSymbol(f),l.addSymbol(c),s.addComponent(n),s.addComponent(o),s.addComponent(l),s}},{key:"getLogicalSpace",value:function(e,t){var i,a,n,o=0,r=0;for(a=0,n=this.toolbars.length;a<n;a++)i=this.toolbars[a].getLogicalSpace(e,t),o=Math.max(i.width,o),r+=i.height,this.toolbars[a].width=i.width,this.toolbars[a].height=i.height;return r+=this.padding,{width:o,height:r}}},{key:"placeInCanvas",value:function(e){var t=this,i=t.tsObject,a=t.config.usrConfig;t.padding=5,i.spaceManagerInstance.add([{name:function(){return"data-aggregator"},ref:function(e){return e[0]},self:function(){return t},priority:function(){return 2},layout:function(e){return e[a.layout||"inline"]},orientation:[{type:function(e){return e[a.orientation||"horizontal"]},position:[{type:function(e){return e[a.position||"bottom"]},alignment:[{type:function(e){return e[a.alignment||"right"]},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(e,t,i,a,n){var o=this.measurement;return o.x=e,o.y=t,o.width=i,o.height=a,this.parentGroup=n,this}},{key:"apply",value:function(e){var t,i,a,n,o,r,l,s,u,d,g,c,f=this,p=f.config,m=p.toolboxComponent.config,h=m.timePeriodSelectMenu,v=m.timeMulSelectMenu,b=m.aggMethodSelectMenu,y=m.applyButton,x=m.resetButton,M=f.tsObject.extData.aggregate||{},S=p.composition.reactiveModel,w=f.aggregation,k=p.composition.impl;if(e){if(p.drawn){l=h.value(),s=v.value(),u=b.value();var P=!0,A=!1,C=void 0;try{for(var T,L=p.avlTimePeriods[Symbol.iterator]();!(P=(T=L.next()).done);P=!0)if(d=T.value,d.name===l){c=d.interval;break}}catch(e){A=!0,C=e}finally{try{!P&&L.return&&L.return()}finally{if(A)throw C}}g=c*Number(s),S.lock().prop("bin-size-ext",g).prop("aggregation-fn-ext",p.avlAggMethods[u]).unlock(),w.binSize=g,w.aggregationMethod=u,y.setState("disabled"),x.removeState("disabled")}else if(l=M.timeUnit&&M.timeUnit.toString().toLowerCase(),s=M.timeMultiplier,u=M.method&&M.method.toString(),f.getValidAggregation(),t=p.validTimePeriod,i=p.validTimePeriodMultiplier,a=p.avlAggMethods,t.includes(l)&&(n=t.indexOf(l),i[n].includes(Number(s))||(s=i[n][0]),o=!0),a[u]&&(r=!0),o||r){if(o){var N=!0,z=!1,I=void 0;try{for(var O,D=p.avlTimePeriods[Symbol.iterator]();!(N=(O=D.next()).done);N=!0)if(d=O.value,d.name===l){c=d.interval;break}}catch(e){z=!0,I=e}finally{try{!N&&D.return&&D.return()}finally{if(z)throw I}}g=c*Number(s),S.lock().prop("bin-size-ext",g).unlock(),w.binSize=g}r&&(S.lock().prop("aggregation-fn-ext",p.avlAggMethods[u]).unlock(),w.aggregationMethod=u),y.setState("disabled"),x.removeState("disabled")}}else k.resetAggregation(),w.binSize=null,w.aggregationMethod=null,x.setState("disabled")}},{key:"rangeOnChange",value:function(){var e,i,a,n,o,r,l,s,u,d,g,c,f,p,m=this,h=m.config,v=h.toolboxComponent.config,b=v.timePeriodSelectMenu,y=v.timeMulSelectMenu,x=v.aggMethodSelectMenu,M=v.applyButton,S=v.resetButton,w=h.composition.reactiveModel,k=m.aggregation;m.getValidAggregation(),g=m.getCurrentAggreation(),c=g.timePeriod,f=g.timePeriodMultiplier,p=g.aggregationMethod,i=[],r=[],u=[],a=h.validTimePeriod,l=h.validTimePeriodMultiplier,d=h.avlAggMethods,M.setState("disabled"),k.binSize===w.prop("bin-size")||p.value!==h.defaultAggMethod&&p.value?S.removeState("disabled"):(k.binSize=null,k.aggregationMethod=null,S.setState("disabled"));var P=!0,A=!1,C=void 0;try{for(var T,L=a[Symbol.iterator]();!(P=(T=L.next()).done);P=!0)e=T.value,i.push({name:t(e),value:e})}catch(e){A=!0,C=e}finally{try{!P&&L.return&&L.return()}finally{if(A)throw C}}if(b.updateList(i),c?b.value(c):b.setPlaceHolderValue(""),n=a.indexOf(c),n>=0){var N=!0,z=!1,I=void 0;try{for(var O,D=l[n][Symbol.iterator]();!(N=(O=D.next()).done);N=!0)o=O.value,r.push({name:o.toString(),value:o.toString()})}catch(e){z=!0,I=e}finally{try{!N&&D.return&&D.return()}finally{if(z)throw I}}}y.updateList(r),f?y.value(f.toString()):y.setPlaceHolderValue("");for(s in d)u.push({name:t(d[s].formalName),value:d[s].nickName});x.updateList(u),p.value?x.value(p.value):x.setPlaceHolderValue(""),h.execute=!0}},{key:"draw",value:function(e,t,i,a,n){var o,r,l,s=this,u=s.config,d=s.measurement,g=s.toolbars,c=u.dataAgg;if(s.getAvailablelAggreagation(),e=void 0===e?d.x:e,t=void 0===t?d.y:t,i=void 0===i?d.width:i,a=void 0===a?d.height:a,n=void 0===n?s.parentGroup:n,i&&a){for(r=0,o=g.length;r<o;r++)l=g[r],l.draw(e,t,n);u.defaultAggMethod=c.getDefaultAggregationMethod().nickName,!u.drawn&&s.apply(1),s.rangeOnChange(),u.drawn=!0}}},{key:"dispose",value:function(){}},{key:"aggregation",get:function(){return this.appliedAggregation},set:function(e){this.appliedAggregation.timePeriod=e.timePeriod,this.appliedAggregation.timePeriodMultiplier=e.timePeriodMultiplier,this.appliedAggregation.aggregationMethod=e.aggregationMethod}}]),n}();return l}}]);
//# sourceMappingURL=data-aggregator-es5.min.js.map