!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){(function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=i(2);!function(i,n){"object"===t(e)&&e.exports?e.exports=i.document?n(i):function(e){if(!e.document)throw new Error("Window with document not present");return n(e,!0)}:i.Aggregator=n(i,!0)}("undefined"!=typeof window?window:void 0,function(e,t){var i=e.FusionCharts;i.register("extension",["private","data-aggregator-ext",function(){i.registerComponent("extensions","data-aggregator-ext",n({FC:i}))}])})}).call(t,i(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();e.exports=function(e){var t=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},a=function(){function a(){i(this,a),this.appliedAggregation={binSize:null,aggregationMethod:null},this.config={}}return n(a,[{key:"getAvailablelAggreagation",value:function(){var e,t,i=this.config,n=i.dataAgg,a=i.avlTimePeriods=n.getAggregationTimeRules();for(i.avlTimeMultiplier=[],t=a.length,e=0;e<t;e++)i.avlTimeMultiplier.push(a[e].possibleFactors)}},{key:"getValidAggregation",value:function(){var e,t,i,n,a,o,l,r,d,g,u,s,c,f=this,p=f.config,h=f.tsObject,v=p.dataAgg,m=p.composition.reactiveModel.model["max-plot-point"],b=p.composition.dataset.category.minimumConsecutiveDifference;for(p.currentTimeLength=h.globalReactiveModel.model["x-axis-visible-range-end"]-h.globalReactiveModel.model["x-axis-visible-range-start"],a=p.avlTimePeriods,o=p.avlTimeMultiplier,r=p.currentTimeLength,p.minBinSize=c=r/m,p.validTimePeriod=[],p.validTimePeriodMultiplier=[],p.avlAggMethods=v.getAllAggregationMethod(),e=0,i=a.length;e<i;e++){for(d=a[e].name,g=a[e].interval,l=[],t=0,n=o[e].length;t<n;t++)s=o[e][t],u=s*g,u>=c&&u>b&&l.push(o[e][t]);l.length>0&&(p.validTimePeriodMultiplier.push(l),p.validTimePeriod.push(d))}}},{key:"getCurrentAggreation",value:function(){var e,t,i,n=this,a=n.config,o=a.dataAgg,l=a.composition,r=l.reactiveModel;return i=r.prop("bin-size")-1,isFinite(i)?(t=o.timeRules.getSuitableInterval(i),e=r.prop("aggregation-fn")):(t={name:"",step:""},a.validTimePeriod[a.validTimePeriod.length-1]=t.name,a.validTimePeriodMultiplier[a.validTimePeriodMultiplier.length-1]=[t.step],e=a.avlAggMethods.invalid={formalName:"",nickName:""}),{timePeriod:t.name,timePeriodMultiplier:t.step,aggregationMethod:{value:e.nickName,text:e.formalName}}}},{key:"init",value:function(t){var i,n,a,o,l=this,r=l.config,d=r.toolboxComponent={},g="tsObject",u=["graphics","globalReactiveModel","chart","spaceManagerInstance","chartInstance","smartLabel","extData",function(){var e=0,t=u.length-1,i="";for(l[g]=l[g]||{},l.requiredParams={},e=0;e<t;++e)i=u[e],l[g][i]=arguments[e]}];return t(u),i=l.tsObject,r.usrConfig=i.extData,n=i.chartInstance.apiInstance,a=n.getComponentStore(),r.composition=o=a.getCanvasByIndex(0).composition,r.dataAgg=o.impl.getDataAggregator(),d.toolbox=e.FC.getComponent("api","toolbox"),d.config={},l.toolbars=[],l.measurement={},l.toolbars.push(l.createToolbar()),o.reactiveModel.onPropsChange(["bin-size","aggregation-fn"],function(){r.flag&&(r.flag=!1,setTimeout(function(){l.rangeOnChange()},200))}),window.Aggregator=l,l}},{key:"createToolbar",value:function(){var e,t,i,n,a,o,l,r,d,g,u,s,c,f,p,h,v,m,b,y,M=this,w=M.config,S=M.tsObject,k=w.toolboxComponent,x=k.toolbox,P=k.config,F=x.HorizontalToolbar,C=x.ComponentGroup,A=x.SymbolStore,T=S.graphics,I=T.paper,B=T.container,D=S.chart,L=S.smartLabel,O={paper:I,chart:D,smartLabel:L,chartContainer:B},z=function(){var e,t,i=o.value(),n=a.value(),l=n,r=w.validTimePeriod,d=w.validTimePeriodMultiplier;e=r.indexOf(i),t=d[e].indexOf(Number(n)),s=[];var g=!0,c=!1,f=void 0;try{for(var p,h=d[e][Symbol.iterator]();!(g=(p=h.next()).done);g=!0)u=p.value,s.push({name:u.toString(),value:u.toString()})}catch(e){c=!0,f=e}finally{try{!g&&h.return&&h.return()}finally{if(c)throw f}}a.updateList(s),t<0?a.value(d[e][0].toString()):a.value(l)},j=function(e){var t=M.getCurrentAggreation();t.timePeriodMultiplier.toString()!==a.value()||t.timePeriod!==o.value()||t.aggregationMethod.value!==l.value()?d.updateVisual("enabled"):d.updateVisual("disabled"),""===l.value()&&l.value(w.defaultAggMethod),""===o.value()&&""===a.value()&&(o.value(w.validTimePeriod[0]),z())};return e=new C(O,{hPadding:4}),t=new C(O,{hPadding:0}),i=new C(O,{hPadding:0}),n=new F(O),y=w.usrConfig.styles||{label:{"font-size":13,"font-family":'"Lucida Grande", "sans-serif"',"font-weight":"normal",fill:"#4b4b4b",height:22},timeMultiplierInputField:{active:{fill:"#fff",labelFill:"#696969",stroke:"#c8cecd",strokeWidth:1,radius:1,shadow:{fill:"#000",opacity:.35},width:50,height:22},inactive:{fill:"#fff","stroke-width":1,stroke:"#ced5d4",labelFill:"#000"}},timePeriodInputField:{active:{fill:"#fff",labelFill:"#696969",stroke:"#c8cecd",strokeWidth:1,radius:1,shadow:{fill:"#000",opacity:.35},width:90,height:22},inactive:{fill:"#fff","stroke-width":1,stroke:"#ced5d4",labelFill:"#000"}},aggregationMethodInputField:{active:{fill:"#fff",labelFill:"#696969",stroke:"#c8cecd",strokeWidth:1,radius:1,shadow:{fill:"#000",opacity:.35},width:100,height:22},inactive:{fill:"#fff","stroke-width":1,stroke:"#ced5d4",labelFill:"#000"}},dropDown:{active:{fill:"#898b8b",labelFill:"#fff"},normal:{fill:"#fff",stroke:"#898b8b",radius:2,labelFill:"#000",hoverFill:"#e6e8e8",hoverLabelFill:"#696969"}},applyButton:{active:{fill:"#555",labelFill:"#f3f3f3",stroke:"#ced5d4",strokeWidth:0,hoverFill:"#555",hoverStrokeWidth:0,hoverStroke:"",radius:1,shadow:{fill:"#000",opacity:.35},width:54,height:22},inactive:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4",labelFill:"#f3f3f3"}},resetButton:{active:{fill:"#898b8b",labelFill:"#f3f3f3",stroke:"#ced5d4",strokeWidth:0,hoverFill:"#898b8b",hoverStrokeWidth:0,hoverStroke:"",radius:1,shadow:{fill:"#000",opacity:.35},width:54,height:22},inactive:{fill:"#bebebe","stroke-width":0,stroke:"#ced5d4",labelFill:"#f3f3f3"}},base:{font:{fontSize:11,fontFamily:'"Lucida Grande", "sans-serif"'}}},b=y||{},b={label:b.label||{},timeMultiplierInputField:{active:b.timeMultiplierInputField&&b.timeMultiplierInputField.active||{},inactive:b.timeMultiplierInputField&&b.timeMultiplierInputField.inactive||{}},timePeriodInputField:{active:b.timePeriodInputField&&b.timePeriodInputField.active||{},inactive:b.timePeriodInputField&&b.timePeriodInputField.inactive||{}},aggregationMethodInputField:{active:b.aggregationMethodInputField&&b.aggregationMethodInputField.active||{},inactive:b.aggregationMethodInputField&&b.aggregationMethodInputField.inactive||{}},dropDown:{active:b.dropDown&&b.dropDown.active||{},normal:b.dropDown&&b.dropDown.normal||{}},applyButton:{active:b.applyButton&&b.applyButton.active||{},inactive:b.applyButton&&b.applyButton.inactive||{}},resetButton:{active:b.resetButton&&b.resetButton.active||{},inactive:b.resetButton&&b.resetButton.inactive||{}},base:{font:b.base&&b.base.font||{}}},e.setConfig({fill:"#fff",borderThickness:0}),t.setConfig({fill:"#fff",borderThickness:0}),i.setConfig({fill:"#fff",borderThickness:0}),n.setConfig({fill:"#fff",borderThickness:0}),c={disabled:{config:{disabled:b.timeMultiplierInputField.inactive}}},f={disabled:{config:{disabled:b.timePeriodInputField.inactive}}},p={disabled:{config:{disabled:b.aggregationMethodInputField.inactive}}},v={disabled:{config:{disabled:b.applyButton.inactive}}},m={disabled:{config:{disabled:b.resetButton.inactive}}},h={selected:{container:{style:{fill:b.dropDown.active.fill}},text:{style:{fill:b.dropDown.active.labelFill}}},normal:{container:{style:{fill:b.dropDown.normal.fill,stroke:b.dropDown.normal.stroke,radius:b.dropDown.normal.radius}},text:{style:{fill:b.dropDown.normal.labelFill}}},hover:{container:{style:{fill:b.dropDown.normal.hoverFill}},text:{style:{fill:b.dropDown.normal.hoverLabelFill}}}},g=new x.Label("Aggregate Data:",O,{container:{height:b.label.height},text:{style:b.label}}),P.timePeriodSelectMenu=o=new x.SelectSymbol({},O,[],Object.assign(b.timePeriodInputField.active,{btnTextStyle:b.base.font,dropDownMenu:h,margin:{right:8}})),o.setStateConfig(c),P.timeMulSelectMenu=a=new x.SelectSymbol({},O,[],Object.assign(b.timeMultiplierInputField.active,{btnTextStyle:b.base.font,dropDownMenu:h,margin:{right:3}})),a.setStateConfig(f),P.aggMethodSelectMenu=l=new x.SelectSymbol({},O,[],Object.assign(b.aggregationMethodInputField.active,{btnTextStyle:b.base.font,margin:{right:11},dropDownMenu:h})),l.setStateConfig(p),P.applyButton=d=new x.Symbol("APPLY",!0,O,Object.assign(b.applyButton.active,{btnTextStyle:b.base.font,margin:{right:3}})).attachEventHandlers({click:function(){M.apply(1)}}),d.setStateConfig(v),P.resetButton=r=new x.Symbol("RESET",!0,O,Object.assign(b.resetButton.active,{btnTextStyle:b.base.font,margin:{right:3}})).attachEventHandlers({click:function(){M.apply(0)}}),r.setStateConfig(m),e.addSymbol(g),t.addSymbol(a),t.addSymbol(o),t.addSymbol(l),i.addSymbol(d),i.addSymbol(r),A.register("textBoxIcon",function(e,t,i,n,a,o,l){var r=e-n/2+o/2,d=e+n/2-o/2,g=t-a/2+l/2,u=t+a/2-l/2;return["M",r,g,"L",d,g,"L",d,u,"L",r,u,"Z"]}),o.attachEventHandlers({textOnChange:function(){z(),j()}}),a.attachEventHandlers({textOnChange:function(){j()}}),l.attachEventHandlers({textOnChange:function(){j()}}),n.addComponent(e),n.addComponent(t),n.addComponent(i),n}},{key:"getLogicalSpace",value:function(e,t){var i,n,a,o=0,l=0;for(n=0,a=this.toolbars.length;n<a;n++)i=this.toolbars[n].getLogicalSpace(e,t),o=Math.max(i.width,o),l+=i.height,this.toolbars[n].width=i.width,this.toolbars[n].height=i.height;return l+=this.padding,{width:o,height:l}}},{key:"placeInCanvas",value:function(e){var t=this,i=t.tsObject,n=t.config.usrConfig;t.padding=5,i.spaceManagerInstance.add([{name:function(){return"data-aggregator"},ref:function(e){return e[0]},self:function(){return t},priority:function(){return 2},layout:function(e){return e[n.layout||"inline"]},orientation:[{type:function(e){return e[n.orientation||"horizontal"]},position:[{type:function(e){return e[n.position||"bottom"]},alignment:[{type:function(e){return e[n.alignment||"right"]},dimensions:[function(){var e=this.getParentComponentGroup();return t.getLogicalSpace(e.getWidth(),e.getHeight())}]}]}]}]}])}},{key:"setDrawingConfiguration",value:function(e,t,i,n,a){var o=this.measurement;return o.x=e,o.y=t,o.width=i,o.height=n,this.parentGroup=a,this}},{key:"apply",value:function(e){var t,i,n,a,o,l,r,d,g,u,s,c,f=this,p=f.config,h=p.toolboxComponent.config,v=h.timePeriodSelectMenu,m=h.timeMulSelectMenu,b=h.aggMethodSelectMenu,y=h.applyButton,M=h.resetButton,w=f.tsObject.extData.aggregate||{},S=p.composition.reactiveModel,k=f.aggregation,x=p.composition.impl;if(e){if(p.drawn){r=v.value(),d=m.value(),g=b.value();var P=!0,F=!1,C=void 0;try{for(var A,T=p.avlTimePeriods[Symbol.iterator]();!(P=(A=T.next()).done);P=!0)if(u=A.value,u.name===r){c=u.interval;break}}catch(e){F=!0,C=e}finally{try{!P&&T.return&&T.return()}finally{if(F)throw C}}s=c*Number(d),S.lock().prop("bin-size-ext",s).prop("aggregation-fn-ext",p.avlAggMethods[g]).unlock(),k.binSize=s,k.aggregationMethod=g,y.updateVisual("disabled"),M.updateVisual("enabled")}else if(r=w.timeUnit&&w.timeUnit.toString().toLowerCase(),d=w.timeMultiplier,g=w.method&&w.method.toString().toLowerCase(),f.getValidAggregation(),t=p.validTimePeriod,i=p.validTimePeriodMultiplier,n=p.avlAggMethods,t.includes(r)&&(a=t.indexOf(r),i[a].includes(Number(d))||(d=i[a][0]),o=!0),n[g]&&(l=!0),o||l){if(o){var I=!0,B=!1,D=void 0;try{for(var L,O=p.avlTimePeriods[Symbol.iterator]();!(I=(L=O.next()).done);I=!0)if(u=L.value,u.name===r){c=u.interval;break}}catch(e){B=!0,D=e}finally{try{!I&&O.return&&O.return()}finally{if(B)throw D}}s=c*Number(d),S.lock().prop("bin-size-ext",s).unlock(),k.binSize=s}l&&(S.lock().prop("aggregation-fn-ext",p.avlAggMethods[g]).unlock(),k.aggregationMethod=g),y.updateVisual("disabled"),M.updateVisual("enabled")}}else x.resetAggregation(),k.binSize=null,k.aggregationMethod=null,M.updateVisual("disabled")}},{key:"rangeOnChange",value:function(){var e,i,n,a,o,l,r,d,g,u,s,c,f,p,h=this,v=h.config,m=v.toolboxComponent.config,b=m.timePeriodSelectMenu,y=m.timeMulSelectMenu,M=m.aggMethodSelectMenu,w=m.applyButton,S=m.resetButton,k=v.composition.reactiveModel,x=h.aggregation;h.getValidAggregation(),s=h.getCurrentAggreation(),c=s.timePeriod,f=s.timePeriodMultiplier,p=s.aggregationMethod,i=[],l=[],g=[],n=v.validTimePeriod,r=v.validTimePeriodMultiplier,u=v.avlAggMethods,w.updateVisual("disabled"),x.binSize===k.prop("bin-size")||p.value!==v.defaultAggMethod&&""!==p.value?S.updateVisual("enabled"):(x.binSize=null,x.aggregationMethod=null,S.updateVisual("disabled"));var P=!0,F=!1,C=void 0;try{for(var A,T=n[Symbol.iterator]();!(P=(A=T.next()).done);P=!0)e=A.value,i.push({name:t(e),value:e})}catch(e){F=!0,C=e}finally{try{!P&&T.return&&T.return()}finally{if(F)throw C}}if(b.updateList(i),b.value(c),a=n.indexOf(c),a>=0){var I=!0,B=!1,D=void 0;try{for(var L,O=r[a][Symbol.iterator]();!(I=(L=O.next()).done);I=!0)o=L.value,l.push({name:o.toString(),value:o.toString()})}catch(e){B=!0,D=e}finally{try{!I&&O.return&&O.return()}finally{if(B)throw D}}}y.updateList(l),y.value(f.toString());for(d in u)g.push({name:t(u[d].formalName),value:u[d].nickName});M.updateList(g),M.value(p.value),v.flag=!0}},{key:"draw",value:function(e,t,i,n,a){var o,l,r,d=this,g=d.config,u=d.measurement,s=d.toolbars,c=g.dataAgg;if(d.getAvailablelAggreagation(),e=void 0===e?u.x:e,t=void 0===t?u.y:t,i=void 0===i?u.width:i,n=void 0===n?u.height:n,a=void 0===a?d.parentGroup:a,i&&n)for(l=0,o=s.length;l<o;l++)r=s[l],r.draw(e,t,a);g.defaultAggMethod=c.getDefaultAggregationMethod().nickName,!g.drawn&&d.apply(1),d.rangeOnChange(),g.drawn=!0}},{key:"dispose",value:function(){}},{key:"aggregation",get:function(){return this.appliedAggregation},set:function(e){this.appliedAggregation.timePeriod=e.timePeriod,this.appliedAggregation.timePeriodMultiplier=e.timePeriodMultiplier,this.appliedAggregation.aggregationMethod=e.aggregationMethod}}]),a}();return a}}]);
//# sourceMappingURL=data-aggregator-ext-es5.min.js.map